From pblumenthal at crsinc.com  Wed Oct  5 12:43:00 2011
From: pblumenthal at crsinc.com (Pete Blumenthal)
Date: Wed, 5 Oct 2011 19:43:00 +0000
Subject: [Slony1-general] Dynamic Schema Changes on high-traffic database
Message-ID: <71583C0762B8A948A4D9E5898D00FD5D22E3C63F@mbx025-e1-nj-8.exch025.domain.local>

I run a web app which allows users to cause dynamic schema changes-adding columns to tables specifically. This operation doesn't happen often, but it happens often enough that we don't want to have to manually SLONIK EXECUTE SCRIPT every time we want to do a schema change. There is also a possibility of write operations happening on the tables with dynamic schema changes at the same times as the schema changes occur.

Which is preferred solution for dynamic schema changes in production with Slony-I 2.0, Why?

A) Method documented in 3.2.2 (http://slony.info/documentation/2.0/ddlchanges.html) . The constraint that "no other transactions are altering the tables being used by the ddl script while it is running" is problematic.  This is less than preferable because it requires that we either lock the tables being changed before we hand the schema change commands to SLONY EXECUTE SCRIPT, causing an outage for some users and possibly aborting related sequences of write operations, or that we risk less-than-perfect replication by running a DDL change in the middle of write operations to the table being changed without any guarantee of concomitant execution on replicated members of the cluster.

B) Drop and merge back in the tables being altered on-the-fly, without any locks being explicitly invoked. Since it is trivial to know the name of the table whose structure is being changed before the change actually occurs, we could use that information in a task sequence like this (using the altperl scripts, but it could also be done directly on the database):
1.      Drop the table that is about to be altered (let's call it TABLE_TO_ALTER) from the main replication set. This would (theoretically) mean that write operations were only being performed on the master.
2.      Run SLONIK EXECUTE SCRIPT on the main replication set, and apply the schema changes to TABLE_TO_ALTER.  I have tested this, and found that whether or not the table is a member of the set, EXECUTE SCRIPT operations are still applied to it on all of the nodes in the set.
3.      Create a temporary set containing only TABLE_TO_ALTER.
4.      Subscribe the temporary set to the same nodes as the main replication set.
5.      Merge the temporary set into the main replication set.

This approach of "stop replication on this table, change the structure of the table, and then re-add it back into the main replication set" sounds preferable because it doesn't risk problems that could be caused by write operations happening near the same time as DDL changes. I understand that it carries a different risk: the risk introduced by removing a table from replication for a short time, and I am willing to accept that.

Would method B) work? Is method A) preferable? How would you implement a solution to this problem?

Thanks for the advice,
  Pete
This email message contains information that Corporate Reimbursement Services, Inc. considers confidential and/or proprietary, or may later designate as confidential and proprietary. It is intended only for use of the individual or entity named above and should not be forwarded to any other persons or entities without the express consent of Corporate Reimbursement Services, Inc., nor should it be used for any purpose other than in the course of any potential or actual business relationship with Corporate Reimbursement Services, Inc. If the reader of this message is not the intended recipient, or the employee or agent responsible to deliver it to the intended recipient, you are hereby notified that any dissemination, distribution, or copying of this communication is strictly prohibited. If you have received this communication in error, please notify sender immediately and destroy the original message.

Internal Revenue Service regulations require that certain types of written advice include a disclaimer. To the extent the preceding message contains advice relating to a Federal tax issue, unless expressly stated otherwise the advice is not intended or written to be used, and it cannot be used by the recipient or any other taxpayer, for the purpose of avoiding Federal tax penalties, and was not written to support the promotion or marketing of any transaction or matter discussed herein.

From JanWieck at Yahoo.com  Wed Oct  5 16:37:23 2011
From: JanWieck at Yahoo.com (Jan Wieck)
Date: Wed, 05 Oct 2011 19:37:23 -0400
Subject: [Slony1-general] Dynamic Schema Changes on high-traffic database
In-Reply-To: <71583C0762B8A948A4D9E5898D00FD5D22E3C63F@mbx025-e1-nj-8.exch025.domain.local>
References: <71583C0762B8A948A4D9E5898D00FD5D22E3C63F@mbx025-e1-nj-8.exch025.domain.local>
Message-ID: <4E8CEA33.7030802@Yahoo.com>

On 10/5/2011 3:43 PM, Pete Blumenthal wrote:
> I run a web app which allows users to cause dynamic schema changes-adding columns to tables specifically. This operation doesn't happen often, but it happens often enough that we don't want to have to manually SLONIK EXECUTE SCRIPT every time we want to do a schema change. There is also a possibility of write operations happening on the tables with dynamic schema changes at the same times as the schema changes occur.
>
> Which is preferred solution for dynamic schema changes in production with Slony-I 2.0, Why?

Applications changing the DB schema during normal production operation 
have always been problematic. Not only with Slony, but with databases, 
that do not cover DDL under transactional semantics, too.

Changes that might happen to Slony 2.2 would make it possible to support 
this in a safe and secure manner, but those changes will most certainly 
not be backported into any earlier version.


Jan

-- 
Anyone who trades liberty for security deserves neither
liberty nor security. -- Benjamin Franklin

From khizer at srishtisoft.com  Tue Oct 11 02:46:03 2011
From: khizer at srishtisoft.com (khizer)
Date: Tue, 11 Oct 2011 15:16:03 +0530
Subject: [Slony1-general] Postgresql-8.2 replication
Message-ID: <4E94105B.1030302@srishtisoft.com>

Hi,

I am trying to compile and install slony in ubuntu OS 10.10

i tried with the command
./configure --prefix=/usr/lib/postgresql/8.2/bin/ 
--with-pgconfigdir=/usr/lib/postgresql/8.2/bin/ 
--with-perltools=/usr/lib/postgresql/8.2/bin/ 
--with-pgpkglibdir=/usr/lib/postgresql/8.2/lib/ 
--with-pgsharedir=/usr/share/postgresql/8.2/ 
--with-pgincludedir=/usr/include/postgresql 
--with-pgincludeserverdir=/usr/include/postgresql/8.2/server

but i am getting error as follow while running
make


from xxid.c:20:
/usr/include/postgresql/8.2/server/tcop/tcopprot.h:30:18: error: 
expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?const?
In file included from 
/usr/include/postgresql/8.2/server/executor/spi.h:37:0,
from xxid.c:20:
/usr/include/postgresql/8.2/server/utils/builtins.h:260:18: error: 
expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
In file included from xxid.c:20:0:
/usr/include/postgresql/8.2/server/executor/spi.h:78:18: error: expected 
?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?uint32?
/usr/include/postgresql/8.2/server/executor/spi.h:79:18: error: expected 
?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?Oid?
/usr/include/postgresql/8.2/server/executor/spi.h:80:18: error: expected 
?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?SPITupleTable?
/usr/include/postgresql/8.2/server/executor/spi.h:81:18: error: expected 
?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
xxid.c:26:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:26:1: warning: no previous prototype for ?Pg_magic_func?
xxid.c:31:0: warning: "SET_VARSIZE" redefined
/usr/include/postgresql/postgres.h:260:0: note: this is the location of 
the previous definition
xxid.c:52:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:52:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidin?
xxid.c:53:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:53:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidout?
xxid.c:54:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:54:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxideq?
xxid.c:55:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:55:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidne?
xxid.c:56:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:56:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidlt?
xxid.c:57:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:57:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidle?
xxid.c:58:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:58:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidgt?
xxid.c:59:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:59:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidge?
xxid.c:60:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:60:1: warning: no previous prototype for 
?pg_finfo__Slony_I_btxxidcmp?
xxid.c:61:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:61:1: warning: no previous prototype for 
?pg_finfo__Slony_I_getCurrentXid?
xxid.c:62:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:62:1: warning: no previous prototype for 
?pg_finfo__Slony_I_getMinXid?
xxid.c:63:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:63:1: warning: no previous prototype for 
?pg_finfo__Slony_I_getMaxXid?
xxid.c:77:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:77:1: warning: no previous prototype for 
?pg_finfo__Slony_I_xxid_snapshot_in?
xxid.c:78:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:78:1: warning: no previous prototype for 
?pg_finfo__Slony_I_xxid_snapshot_out?
xxid.c:79:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:79:1: warning: no previous prototype for 
?pg_finfo__Slony_I_xxid_lt_snapshot?
xxid.c:80:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
before ?const?
xxid.c:80:1: warning: no previous prototype for 
?pg_finfo__Slony_I_xxid_ge_snapshot?
xxid.c: In function ?_Slony_I_getMinXid?:
xxid.c:243:6: error: ?SerializableSnapshot? undeclared (first use in 
this function)
xxid.c:243:6: note: each undeclared identifier is reported only once for 
each function it appears in
xxid.c: In function ?_Slony_I_getMaxXid?:
xxid.c:259:6: error: ?SerializableSnapshot? undeclared (first use in 
this function)
xxid.c: In function ?_Slony_I_xxid_snapshot_in?:
xxid.c:337:2: warning: implicit declaration of function ?VARATT_SIZEP?
xxid.c:337:2: error: lvalue required as left operand of assignment
xxid.c: In function ?_Slony_I_getMaxXid?:
xxid.c:263:1: warning: control reaches end of non-void function
xxid.c: In function ?_Slony_I_getMinXid?:
xxid.c:247:1: warning: control reaches end of non-void function
make[2]: *** [xxid.o] Error 1
make[2]: Leaving directory `/home/karthika/slony1-1.2.22/src/xxid'
make[1]: *** [all] Error 2
make[1]: Leaving directory `/home/karthika/slony1-1.2.22/src'
make: *** [all] Error 2



Mehdi


From devrim at gunduz.org  Tue Oct 11 06:51:58 2011
From: devrim at gunduz.org (Devrim =?ISO-8859-1?Q?G=DCND=DCZ?=)
Date: Tue, 11 Oct 2011 16:51:58 +0300
Subject: [Slony1-general] Postgresql-8.2 replication
In-Reply-To: <4E94105B.1030302@srishtisoft.com>
References: <4E94105B.1030302@srishtisoft.com>
Message-ID: <1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>


I don't think that Slony 2.X will work against PostgreSQL 8.2. You need
to use 1.2.X.

That said, PostgreSQL 8.2 will be EOLed by the end of this year, or so.

Regards,
Devrim

On Tue, 2011-10-11 at 15:16 +0530, khizer wrote:
> Hi,
> 
> I am trying to compile and install slony in ubuntu OS 10.10
> 
> i tried with the command
> ./configure --prefix=/usr/lib/postgresql/8.2/bin/ 
> --with-pgconfigdir=/usr/lib/postgresql/8.2/bin/ 
> --with-perltools=/usr/lib/postgresql/8.2/bin/ 
> --with-pgpkglibdir=/usr/lib/postgresql/8.2/lib/ 
> --with-pgsharedir=/usr/share/postgresql/8.2/ 
> --with-pgincludedir=/usr/include/postgresql 
> --with-pgincludeserverdir=/usr/include/postgresql/8.2/server
> 
> but i am getting error as follow while running
> make
> 
> 
> from xxid.c:20:
> /usr/include/postgresql/8.2/server/tcop/tcopprot.h:30:18: error: 
> expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?const?
> In file included from 
> /usr/include/postgresql/8.2/server/executor/spi.h:37:0,
> from xxid.c:20:
> /usr/include/postgresql/8.2/server/utils/builtins.h:260:18: error: 
> expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
> In file included from xxid.c:20:0:
> /usr/include/postgresql/8.2/server/executor/spi.h:78:18: error: expected 
> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?uint32?
> /usr/include/postgresql/8.2/server/executor/spi.h:79:18: error: expected 
> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?Oid?
> /usr/include/postgresql/8.2/server/executor/spi.h:80:18: error: expected 
> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?SPITupleTable?
> /usr/include/postgresql/8.2/server/executor/spi.h:81:18: error: expected 
> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
> xxid.c:26:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:26:1: warning: no previous prototype for ?Pg_magic_func?
> xxid.c:31:0: warning: "SET_VARSIZE" redefined
> /usr/include/postgresql/postgres.h:260:0: note: this is the location of 
> the previous definition
> xxid.c:52:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:52:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidin?
> xxid.c:53:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:53:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidout?
> xxid.c:54:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:54:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxideq?
> xxid.c:55:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:55:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidne?
> xxid.c:56:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:56:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidlt?
> xxid.c:57:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:57:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidle?
> xxid.c:58:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:58:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidgt?
> xxid.c:59:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:59:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidge?
> xxid.c:60:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:60:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_btxxidcmp?
> xxid.c:61:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:61:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_getCurrentXid?
> xxid.c:62:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:62:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_getMinXid?
> xxid.c:63:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:63:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_getMaxXid?
> xxid.c:77:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:77:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_xxid_snapshot_in?
> xxid.c:78:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:78:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_xxid_snapshot_out?
> xxid.c:79:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:79:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_xxid_lt_snapshot?
> xxid.c:80:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? 
> before ?const?
> xxid.c:80:1: warning: no previous prototype for 
> ?pg_finfo__Slony_I_xxid_ge_snapshot?
> xxid.c: In function ?_Slony_I_getMinXid?:
> xxid.c:243:6: error: ?SerializableSnapshot? undeclared (first use in 
> this function)
> xxid.c:243:6: note: each undeclared identifier is reported only once for 
> each function it appears in
> xxid.c: In function ?_Slony_I_getMaxXid?:
> xxid.c:259:6: error: ?SerializableSnapshot? undeclared (first use in 
> this function)
> xxid.c: In function ?_Slony_I_xxid_snapshot_in?:
> xxid.c:337:2: warning: implicit declaration of function ?VARATT_SIZEP?
> xxid.c:337:2: error: lvalue required as left operand of assignment
> xxid.c: In function ?_Slony_I_getMaxXid?:
> xxid.c:263:1: warning: control reaches end of non-void function
> xxid.c: In function ?_Slony_I_getMinXid?:
> xxid.c:247:1: warning: control reaches end of non-void function
> make[2]: *** [xxid.o] Error 1
> make[2]: Leaving directory `/home/karthika/slony1-1.2.22/src/xxid'
> make[1]: *** [all] Error 2
> make[1]: Leaving directory `/home/karthika/slony1-1.2.22/src'
> make: *** [all] Error 2
> 
> 
> 
> Mehdi
> 
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


-- 
Devrim G?ND?Z
Principal Systems Engineer @ EnterpriseDB: http://www.enterprisedb.com
PostgreSQL Dan??man?/Consultant, Red Hat Certified Engineer
Community: devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
http://www.gunduz.org  Twitter: http://twitter.com/devrimgunduz
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20111011/60edd41e/attachment.pgp 

From francescoboccacci at libero.it  Tue Oct 11 07:00:49 2011
From: francescoboccacci at libero.it (francescoboccacci at libero.it)
Date: Tue, 11 Oct 2011 16:00:49 +0200 (CEST)
Subject: [Slony1-general] A store path dubt
Message-ID: <28969183.296561318341649005.JavaMail.defaultUser@defaultHost>

Hi everyone,
i have i dubt (just one??). My  slony replica is working fine between 2 server 
(Master - Slave). I read some slony documentation about slony functionality and 
i saw thatt all slony exaplem in cluster script have 2 store path (one master -
salve and the other slave-master). In my cluster script i have just one:

    store path (server = 1, client = 2, conninfo = 'dbname=$DB1  host=$H1 
user=$U');

dbname etc .. belong to master.
What does it mean? Why is my replica working fine with just one store path?



    Thanks
    Francesco

From khizer at srishtisoft.com  Tue Oct 11 07:34:24 2011
From: khizer at srishtisoft.com (khizer)
Date: Tue, 11 Oct 2011 20:04:24 +0530
Subject: [Slony1-general] Postgresql-8.2 replication
In-Reply-To: <1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>
References: <4E94105B.1030302@srishtisoft.com>
	<1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>
Message-ID: <4E9453F0.30804@srishtisoft.com>

I am using slony 1.2.*  for postgresql-8.2

Ru aware of any other method of replication for postgresql-8.2

On 10/11/2011 07:21 PM, Devrim G?ND?Z wrote:
> I don't think that Slony 2.X will work against PostgreSQL 8.2. You need
> to use 1.2.X.
>
> That said, PostgreSQL 8.2 will be EOLed by the end of this year, or so.
>
> Regards,
> Devrim
>
> On Tue, 2011-10-11 at 15:16 +0530, khizer wrote:
>> Hi,
>>
>> I am trying to compile and install slony in ubuntu OS 10.10
>>
>> i tried with the command
>> ./configure --prefix=/usr/lib/postgresql/8.2/bin/
>> --with-pgconfigdir=/usr/lib/postgresql/8.2/bin/
>> --with-perltools=/usr/lib/postgresql/8.2/bin/
>> --with-pgpkglibdir=/usr/lib/postgresql/8.2/lib/
>> --with-pgsharedir=/usr/share/postgresql/8.2/
>> --with-pgincludedir=/usr/include/postgresql
>> --with-pgincludeserverdir=/usr/include/postgresql/8.2/server
>>
>> but i am getting error as follow while running
>> make
>>
>>
>> from xxid.c:20:
>> /usr/include/postgresql/8.2/server/tcop/tcopprot.h:30:18: error:
>> expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?const?
>> In file included from
>> /usr/include/postgresql/8.2/server/executor/spi.h:37:0,
>> from xxid.c:20:
>> /usr/include/postgresql/8.2/server/utils/builtins.h:260:18: error:
>> expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
>> In file included from xxid.c:20:0:
>> /usr/include/postgresql/8.2/server/executor/spi.h:78:18: error: expected
>> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?uint32?
>> /usr/include/postgresql/8.2/server/executor/spi.h:79:18: error: expected
>> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?Oid?
>> /usr/include/postgresql/8.2/server/executor/spi.h:80:18: error: expected
>> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?SPITupleTable?
>> /usr/include/postgresql/8.2/server/executor/spi.h:81:18: error: expected
>> ?=?, ?,?, ?;?, ?asm? or ?__attribute__? before ?int?
>> xxid.c:26:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:26:1: warning: no previous prototype for ?Pg_magic_func?
>> xxid.c:31:0: warning: "SET_VARSIZE" redefined
>> /usr/include/postgresql/postgres.h:260:0: note: this is the location of
>> the previous definition
>> xxid.c:52:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:52:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidin?
>> xxid.c:53:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:53:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidout?
>> xxid.c:54:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:54:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxideq?
>> xxid.c:55:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:55:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidne?
>> xxid.c:56:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:56:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidlt?
>> xxid.c:57:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:57:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidle?
>> xxid.c:58:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:58:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidgt?
>> xxid.c:59:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:59:1: warning: no previous prototype for ?pg_finfo__Slony_I_xxidge?
>> xxid.c:60:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:60:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_btxxidcmp?
>> xxid.c:61:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:61:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_getCurrentXid?
>> xxid.c:62:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:62:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_getMinXid?
>> xxid.c:63:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:63:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_getMaxXid?
>> xxid.c:77:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:77:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_xxid_snapshot_in?
>> xxid.c:78:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:78:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_xxid_snapshot_out?
>> xxid.c:79:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:79:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_xxid_lt_snapshot?
>> xxid.c:80:1: error: expected ?=?, ?,?, ?;?, ?asm? or ?__attribute__?
>> before ?const?
>> xxid.c:80:1: warning: no previous prototype for
>> ?pg_finfo__Slony_I_xxid_ge_snapshot?
>> xxid.c: In function ?_Slony_I_getMinXid?:
>> xxid.c:243:6: error: ?SerializableSnapshot? undeclared (first use in
>> this function)
>> xxid.c:243:6: note: each undeclared identifier is reported only once for
>> each function it appears in
>> xxid.c: In function ?_Slony_I_getMaxXid?:
>> xxid.c:259:6: error: ?SerializableSnapshot? undeclared (first use in
>> this function)
>> xxid.c: In function ?_Slony_I_xxid_snapshot_in?:
>> xxid.c:337:2: warning: implicit declaration of function ?VARATT_SIZEP?
>> xxid.c:337:2: error: lvalue required as left operand of assignment
>> xxid.c: In function ?_Slony_I_getMaxXid?:
>> xxid.c:263:1: warning: control reaches end of non-void function
>> xxid.c: In function ?_Slony_I_getMinXid?:
>> xxid.c:247:1: warning: control reaches end of non-void function
>> make[2]: *** [xxid.o] Error 1
>> make[2]: Leaving directory `/home/karthika/slony1-1.2.22/src/xxid'
>> make[1]: *** [all] Error 2
>> make[1]: Leaving directory `/home/karthika/slony1-1.2.22/src'
>> make: *** [all] Error 2
>>
>>
>>
>> Mehdi
>>
>> _______________________________________________
>> Slony1-general mailing list
>> Slony1-general at lists.slony.info
>> http://lists.slony.info/mailman/listinfo/slony1-general
>


From cbbrowne at afilias.info  Tue Oct 11 08:16:43 2011
From: cbbrowne at afilias.info (Christopher Browne)
Date: Tue, 11 Oct 2011 11:16:43 -0400
Subject: [Slony1-general] A store path dubt
In-Reply-To: <28969183.296561318341649005.JavaMail.defaultUser@defaultHost>
References: <28969183.296561318341649005.JavaMail.defaultUser@defaultHost>
Message-ID: <CANfbgbb4c6BNDW4vQBKWYJJnZSV_QA-L=kvKesh9Rfvf6BENSw@mail.gmail.com>

On Tue, Oct 11, 2011 at 10:00 AM, francescoboccacci at libero.it
<francescoboccacci at libero.it> wrote:
> Hi everyone,
> i have i dubt (just one??). My ?slony replica is working fine between 2 server
> (Master - Slave). I read some slony documentation about slony functionality and
> i saw thatt all slony exaplem in cluster script have 2 store path (one master -
> salve and the other slave-master). In my cluster script i have just one:
>
> ? ?store path (server = 1, client = 2, conninfo = 'dbname=$DB1 ?host=$H1
> user=$U');
>
> dbname etc .. belong to master.
> What does it mean? Why is my replica working fine with just one store path?

In the absence of a return path, you'll have the problem that the slon
managing the origin node isn't receiving any events from the
subscriber node, with several ill effects:

a) Confirmations won't be getting back to the origin
b) Since confirmations don't make it, the origin never knows that it
can trim old data from log tables, and you can expect to see bloating
of such tables as:
 - sl_event
 - sl_confirm
 - sl_log_1
 - sl_log_2
 - sl_seqlog

From scott.marlowe at gmail.com  Tue Oct 11 08:20:29 2011
From: scott.marlowe at gmail.com (Scott Marlowe)
Date: Tue, 11 Oct 2011 09:20:29 -0600
Subject: [Slony1-general] Postgresql-8.2 replication
In-Reply-To: <4E9453F0.30804@srishtisoft.com>
References: <4E94105B.1030302@srishtisoft.com>
	<1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>
	<4E9453F0.30804@srishtisoft.com>
Message-ID: <CAOR=d=2nGs2rUSXf4RHD_qgBZrTxTybkwLn9wBr3hJqTi6=XcA@mail.gmail.com>

2011/10/11 khizer <khizer at srishtisoft.com>:
> I am using slony 1.2.* ?for postgresql-8.2
Which exact version are you trying to use?

From ssinger at ca.afilias.info  Tue Oct 11 13:48:40 2011
From: ssinger at ca.afilias.info (Steve Singer)
Date: Tue, 11 Oct 2011 16:48:40 -0400
Subject: [Slony1-general] Slony-I 2.1.0 RC2 released
Message-ID: <4E94ABA8.3000001@ca.afilias.info>

The second release candidate for 2.1.0 has been released.

This release candidate includes only three changes from the last release 
candidate.

- Bug #236 :: Fix default formatting of timestamp in logs
- Add support for PostgreSQL 9.1.  Simply marking it a supported version
- Bug #237 :: Drop set did not remove truncate triggers.

We plan on waiting at least a week before releasing 2.1.0 final.  If no 
serious issues are found we hope to release 2.1.0 next week or early the 
following week.

You can find get the 2.1.0 RC2 at

http://www.slony.info/downloads/2.1/source/slony1-2.1.0.rc2.tar.bz2
http://www.slony.info/downloads/2.1/source/slony1-2.1.0.rc2-docs.tar.bz2


Steve


From scott.marlowe at gmail.com  Tue Oct 11 22:15:09 2011
From: scott.marlowe at gmail.com (Scott Marlowe)
Date: Tue, 11 Oct 2011 23:15:09 -0600
Subject: [Slony1-general] Postgresql-8.2 replication
In-Reply-To: <4E951EB0.2080107@srishtisoft.com>
References: <4E94105B.1030302@srishtisoft.com>
	<1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>
	<4E9453F0.30804@srishtisoft.com>
	<CAOR=d=2nGs2rUSXf4RHD_qgBZrTxTybkwLn9wBr3hJqTi6=XcA@mail.gmail.com>
	<4E951EB0.2080107@srishtisoft.com>
Message-ID: <CAOR=d=3yUg4nP7sFKi4jeno=fy4sNP8G99zKbC=LxW=dybzxiQ@mail.gmail.com>

2011/10/11 khizer <khizer at srishtisoft.com>:
> I am using slony 1.2.22 i tried with 1.2.9 also but same problem exist ?is
> it related some headers.
>
> i have attached the error file as above

How does it do if you just do:

make distclean
./configure --prefix=/usr/lib/postgresql/8.2/bin/
--with-pgconfigdir=/usr/lib/postgresql/8.2/bin/

?

From glynastill at yahoo.co.uk  Wed Oct 12 01:46:28 2011
From: glynastill at yahoo.co.uk (Glyn Astill)
Date: Wed, 12 Oct 2011 09:46:28 +0100 (BST)
Subject: [Slony1-general] Slony-I 2.1.0 RC2 released
In-Reply-To: <4E94ABA8.3000001@ca.afilias.info>
References: <4E94ABA8.3000001@ca.afilias.info>
Message-ID: <1318409188.3419.YahooMailNeo@web26002.mail.ukl.yahoo.com>

>From: Steve Singer <ssinger at ca.afilias.info>

>

>The second release candidate for 2.1.0 has been released.
>
>This release candidate includes only three changes from the last release 
>candidate.
>
>- Bug #236 :: Fix default formatting of timestamp in logs
>- Add support for PostgreSQL 9.1.? Simply marking it a supported version
>- Bug #237 :: Drop set did not remove truncate triggers.
>
>We plan on waiting at least a week before releasing 2.1.0 final.? If no 
>serious issues are found we hope to release 2.1.0 next week or early the 
>following week.
>

Just out of interest, how complicated will the upgrade path be from 2.0 to 2.1?


From khizer at srishtisoft.com  Tue Oct 11 21:59:28 2011
From: khizer at srishtisoft.com (khizer)
Date: Wed, 12 Oct 2011 10:29:28 +0530
Subject: [Slony1-general] Postgresql-8.2 replication
In-Reply-To: <CAOR=d=2nGs2rUSXf4RHD_qgBZrTxTybkwLn9wBr3hJqTi6=XcA@mail.gmail.com>
References: <4E94105B.1030302@srishtisoft.com>	<1318341120.2052.14.camel@lenovo01-laptop03.gunduz.org>	<4E9453F0.30804@srishtisoft.com>
	<CAOR=d=2nGs2rUSXf4RHD_qgBZrTxTybkwLn9wBr3hJqTi6=XcA@mail.gmail.com>
Message-ID: <4E951EB0.2080107@srishtisoft.com>

I am using slony 1.2.22 i tried with 1.2.9 also but same problem exist  
is it related some headers.

i have attached the error file as above



On 10/11/2011 08:50 PM, Scott Marlowe wrote:
> 2011/10/11 khizer<khizer at srishtisoft.com>:
>> I am using slony 1.2.*  for postgresql-8.2
> Which exact version are you trying to use?
>

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: slony_err.txt
Url: http://lists.slony.info/pipermail/slony1-general/attachments/20111012/ce126947/attachment.txt 

From ssinger at ca.afilias.info  Wed Oct 12 07:00:58 2011
From: ssinger at ca.afilias.info (Steve Singer)
Date: Wed, 12 Oct 2011 10:00:58 -0400
Subject: [Slony1-general] Slony-I 2.1.0 RC2 released
In-Reply-To: <1318409188.3419.YahooMailNeo@web26002.mail.ukl.yahoo.com>
References: <4E94ABA8.3000001@ca.afilias.info>
	<1318409188.3419.YahooMailNeo@web26002.mail.ukl.yahoo.com>
Message-ID: <4E959D9A.9060108@ca.afilias.info>

On 11-10-12 04:46 AM, Glyn Astill wrote:
>> From: Steve Singer<ssinger at ca.afilias.info>
>
>>
>
>> The second release candidate for 2.1.0 has been released.
>>
>> This release candidate includes only three changes from the last release
>> candidate.
>>
>> - Bug #236 :: Fix default formatting of timestamp in logs
>> - Add support for PostgreSQL 9.1.  Simply marking it a supported version
>> - Bug #237 :: Drop set did not remove truncate triggers.
>>
>> We plan on waiting at least a week before releasing 2.1.0 final.  If no
>> serious issues are found we hope to release 2.1.0 next week or early the
>> following week.
>>
>
> Just out of interest, how complicated will the upgrade path be from 2.0 to 2.1?

In terms of the upgrade procedure it should be similar to the upgrade of 
a minor 2.0.x to 2.0.y type of upgrade ie  install the new version on 
all nodes and run UPDATE FUNCTIONS on all nodes.

You will also need to review all of your slonik scripts to make sure 
they still work, some improperly written slonik scripts won't behave the 
same with the implicit wait for changes.


From willybas at gmail.com  Tue Oct 18 13:01:23 2011
From: willybas at gmail.com (Willy-Bas Loos)
Date: Tue, 18 Oct 2011 22:01:23 +0200
Subject: [Slony1-general]  make uninstall
Message-ID: <CAHnozTgJvZr+LMsthikK5K71CdhubyjdXQg1tkJO8fC-H0WxHA@mail.gmail.com>

Hi,

Is there a way to remove an installation of slony I 2.0 when it was
compiled from source (ubuntu)  ?

Make uninstall doesn't seem to work.
It's only a virtual test box, so there is no pain.
checkinstall might be useful.

So, just checking.. is there a way to uninstall after a
configure;make;make install ?

Cheers,

WBL

-- 
"Patriotism is the conviction that your country is superior to all
others because you were born in it." -- George Bernard Shaw

From cbbrowne at afilias.info  Tue Oct 18 13:17:00 2011
From: cbbrowne at afilias.info (Christopher Browne)
Date: Tue, 18 Oct 2011 16:17:00 -0400
Subject: [Slony1-general] make uninstall
In-Reply-To: <CAHnozTgJvZr+LMsthikK5K71CdhubyjdXQg1tkJO8fC-H0WxHA@mail.gmail.com>
References: <CAHnozTgJvZr+LMsthikK5K71CdhubyjdXQg1tkJO8fC-H0WxHA@mail.gmail.com>
Message-ID: <CANfbgbaAki1wJPVFEPhXVzf8FtHr-ei5xM-3GeuFE44ysS85mw@mail.gmail.com>

On Tue, Oct 18, 2011 at 4:01 PM, Willy-Bas Loos <willybas at gmail.com> wrote:
> Hi,
>
> Is there a way to remove an installation of slony I 2.0 when it was
> compiled from source (ubuntu) ??
>
> Make uninstall doesn't seem to work.
> It's only a virtual test box, so there is no pain.
> checkinstall might be useful.
>
> So, just checking.. is there a way to uninstall after a
> configure;make;make install ?

We haven't prepared such a make target.

It's an interesting idea, and if there isn't a compelling reason *not*
to do so, perhaps we should consider doing so.  I observe that
PostgreSQL does have a "make uninstall" once you head to its src
directory, so there's certainly a precedent to consider following.

The relevant bits of postgresql src/Makefile
----------------------------------------------------------------------------
uninstall: uninstall-local

uninstall-local:
        rm -f $(addprefix '$(DESTDIR)$(pgxsdir)/$(subdir)'/,
Makefile.global Makefile.port Makefile.shlib nls-global.mk)
----------------------------------------------------------------------------

From drj at inigral.com  Tue Oct 18 19:00:16 2011
From: drj at inigral.com (Daniel Jabbour)
Date: Tue, 18 Oct 2011 19:00:16 -0700
Subject: [Slony1-general] Replicating between different schemas
Message-ID: <FC93D4BF-9BF5-4D44-B42F-F92DB2B2F221@inigral.com>

Hi,

I have been playing with Slony for the last couple of days. I have it replicating successfully in our setup, but I'm trying to figure out how to replicate between two different database schemas on the master provider and subscriber databases.

What I'm trying to accomplish:

* I have 60 individual DBs which are really different instances of the same database schema with slightly different data.
* I want to replicate two tables (T1 and T2) from each master (M1...M50) to a single subscriber (S), consolidating the data into a single database.
* I do not want to merge the data, just namespace it separately into postgres schemas (M1's public.T1 goes to S's m1.T1)

I see the add table command for slonik takes a fully qualified name, including the schema. However, how do I configure it to store to a different qualified name in the subscriber?

Thanks,
Daniel

--
Daniel Jabbour
Senior Agnostic Algorithmatist
Inigral, Inc. | The Social Web For Education
drj | at | inigral | dot | com

