From ssinger at ca.afilias.info  Thu Oct  7 09:58:06 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Thu, 07 Oct 2010 12:58:06 -0400
Subject: [Slony1-general] Slony-I 2.0.5 Released
Message-ID: <4CADFC1E.7010400@ca.afilias.info>

The Slony team is pleased to announce the release of version 2.0.5 of 
the Slony-1 replication system.


The release is available at

http://www.slony.info/downloads/2.0/source/slony1-2.0.5.tar.bz2
http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2


2.0.5 fixes more than 24 issues found from 2.0.4 and earlier versions, 
remedying many issues found during an extensive testing period.

The following issues visibly change Slony-I behaviour, and thus warrant 
extra attention from existing users:

-Bug #121 SUBSCRIBE SET is now submitted against the set origin not the 
provider.
-Bug #40 Slony now requires a thread-safe libpq  on all platforms.


See the release notes (RELEASE file) for more details and a complete 
list of changes.

From dave.gauthier at intel.com  Thu Oct  7 10:05:10 2010
From: dave.gauthier at intel.com (Gauthier, Dave)
Date: Thu, 7 Oct 2010 10:05:10 -0700
Subject: [Slony1-general] [GENERAL] Slony-I 2.0.5 Released
In-Reply-To: <4CADFC1E.7010400@ca.afilias.info>
References: <4CADFC1E.7010400@ca.afilias.info>
Message-ID: <482E80323A35A54498B8B70FF2B879800476D56105@azsmsx504.amr.corp.intel.com>

What are the pros/cons of using Slony vs the nre streaming replication in v9?

-----Original Message-----
From: pgsql-general-owner at postgresql.org [mailto:pgsql-general-owner at postgresql.org] On Behalf Of Steve Singer
Sent: Thursday, October 07, 2010 12:58 PM
To: slony1-general; pgsql-general at postgresql.org; pgsql-announce at postgresql.org
Subject: [GENERAL] Slony-I 2.0.5 Released

The Slony team is pleased to announce the release of version 2.0.5 of 
the Slony-1 replication system.


The release is available at

http://www.slony.info/downloads/2.0/source/slony1-2.0.5.tar.bz2
http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2


2.0.5 fixes more than 24 issues found from 2.0.4 and earlier versions, 
remedying many issues found during an extensive testing period.

The following issues visibly change Slony-I behaviour, and thus warrant 
extra attention from existing users:

-Bug #121 SUBSCRIBE SET is now submitted against the set origin not the 
provider.
-Bug #40 Slony now requires a thread-safe libpq  on all platforms.


See the release notes (RELEASE file) for more details and a complete 
list of changes.

-- 
Sent via pgsql-general mailing list (pgsql-general at postgresql.org)
To make changes to your subscription:
http://www.postgresql.org/mailpref/pgsql-general

From cbbrowne at ca.afilias.info  Thu Oct  7 10:30:06 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Thu, 07 Oct 2010 13:30:06 -0400
Subject: [Slony1-general] [GENERAL] Slony-I 2.0.5 Released
In-Reply-To: <482E80323A35A54498B8B70FF2B879800476D56105@azsmsx504.amr.corp.intel.com>
	(Dave Gauthier's message of "Thu, 7 Oct 2010 10:05:10 -0700")
References: <4CADFC1E.7010400@ca.afilias.info>
	<482E80323A35A54498B8B70FF2B879800476D56105@azsmsx504.amr.corp.intel.com>
Message-ID: <87bp75c3mp.fsf@cbbrowne.afilias-int.info>

"Gauthier, Dave" <dave.gauthier at intel.com> writes:
> What are the pros/cons of using Slony vs the nre streaming replication in v9?

- The built-in WAL-based replication is probably somewhat simpler to set
  up than Slony.

- WAL-based replication readily captures DDL changes, which are very
  much more troublesome with Slony.

- WAL-based replication carries over *ALL* changes, in binary form,
  going into the "master," and is therefore unable to cope with the
  following cases:

  - Replicating between different versions of PostgreSQL (e.g. - from
    8.3 to 9.0)

  - Replicating between different architectures (e.g. - from Linux/x86
    to AIX/PowerPC)

  - Replicating only part of a database cluster (e.g. - specific tables
    and sequences)

  - Having any kind of updates running against replicas (e.g. - running
    triggers on replicas that manage caches)

  - Having even the slightest schema differences between nodes (e.g.
    - different indexes)

If you need any of the 5 items listed (and this is taken off the top of
my head; not quite comprehensive), then the WAL-based replication built
into PostgreSQL will NOT be acceptable, as it will not satisfy those
sorts of needs.

There are replication "use cases" where the form of replication built
into PostgreSQL 9.0 makes it unnecessary to consider Slony-I (and
related systems like Londiste and Bucardo).  But there are cases where
the built-in stuff won't work out.
-- 
output = reverse("ofni.sailifa" "@" "enworbbc")
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From atsaloli.tech at gmail.com  Thu Oct  7 11:08:52 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Thu, 7 Oct 2010 11:08:52 -0700
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
Message-ID: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>

Hi.  We're using 1.2.20 right now.  It's not the latest version either
way you look at it.  Should we upgrade to 1.2.21 or 2.0.5?

We have 2 replication sets now: the whole shebang, and selected tables
and sequences.

It's working really well.

Our only pain points are listed below.  Would upgrading to 2.0.5
help with these?  Or if there is some other compelling reason to
move from 1.x branch to 2.x?  So far the only difference I was able
to fathom is that replicating sequences is much much more efficient
in 2.x.   Is there anything else?

Our pain points are:

-  the database runs a bit slower slower when replication is enabled.

   Slony seems to have quite a bit of overhead:

   I see it doing about 890  inserts per second, and same again for
   deletes.   that's 1780 SQL ops per second.

   By comparison, updates (and slony does not use updates AFAIK so this is
   my application's queries) run about 20 updates per second.

   I don't yet understand why we have a 1:89 ratio between updates by the
   application and Slony inserts/deletes.  I don't know Slony internals
   well enough yet.  But would going to 2.x change that ratio?
   We do replicate sequences.

- sometimes after the slave goes offline, or there is a WAN problem,
  the check_postgres.pl Nagios plug-in (check_slony) reports the slave
  as lagged, even after the slave and master are both online and can
  talk to each other -- restarting the slon master and slave resolves this.
  Otherwise the replication lag time does not decrement / catch up, but
  falls further behind with the clock.

So do we have a good reason to go to 2.x?  Or should we let it shake out
a bit longer?

Best,
Aleksey

From cbbrowne at ca.afilias.info  Thu Oct  7 11:48:53 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Thu, 07 Oct 2010 14:48:53 -0400
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
	1.2.21 or 2.0.5?
In-Reply-To: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
	(Aleksey Tsalolikhin's message of "Thu, 7 Oct 2010 11:08:52 -0700")
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
Message-ID: <877hhtbzze.fsf@cbbrowne.afilias-int.info>

Aleksey Tsalolikhin <atsaloli.tech at gmail.com> writes:
> Hi.  We're using 1.2.20 right now.  It's not the latest version either
> way you look at it.  Should we upgrade to 1.2.21 or 2.0.5?
>
> We have 2 replication sets now: the whole shebang, and selected tables
> and sequences.
>
> It's working really well.
>
> Our only pain points are listed below.  Would upgrading to 2.0.5
> help with these?  Or if there is some other compelling reason to
> move from 1.x branch to 2.x?  So far the only difference I was able
> to fathom is that replicating sequences is much much more efficient
> in 2.x.   Is there anything else?
>
> Our pain points are:
>
> -  the database runs a bit slower slower when replication is enabled.
>
>    Slony seems to have quite a bit of overhead:
>
>    I see it doing about 890  inserts per second, and same again for
>    deletes.   that's 1780 SQL ops per second.
>
>    By comparison, updates (and slony does not use updates AFAIK so this is
>    my application's queries) run about 20 updates per second.
>
>    I don't yet understand why we have a 1:89 ratio between updates by the
>    application and Slony inserts/deletes.  I don't know Slony internals
>    well enough yet.  But would going to 2.x change that ratio?
>    We do replicate sequences.

BTW, Slony *does* do UPDATEs; pulling the little bit from
src/slon/remote_worker.c:

	/*
	 * Add the actual replicating command to the line buffer
	 */
	line->line_largemem += largemem;
	switch (*log_cmdtype)
	{
		case 'I':
			slon_appendquery(&(line->data),
							 "insert into %s %s;\n",
							 wd->tab_fqname[log_tableid],
							 log_cmddata);
			num_inserts ++;
			break;
		case 'U':
			slon_appendquery(&(line->data),
							 "update only %s set %s;\n",
							 wd->tab_fqname[log_tableid],
							 log_cmddata);
			num_updates ++;
			break;
		case 'D':
			slon_appendquery(&(line->data),
						   "delete from only %s where %s;\n",
							 wd->tab_fqname[log_tableid],
							 log_cmddata);
			num_deletes ++;
			break;
	}

The 'U' bit in the middle does updates :-).

Do you have a lot of sequences?  

In 1.2, every sequence gets its values updated every time a SYNC is
processed, which means that if you have a bunch that are seldom touched,
they'll lead to quite a few updates travelling around.

In 2.0, the sequence handling is rather lazier; if the value hasn't
changed since the last SYNC, the slon doesn't bother propagating
anything for that sequence.

If you've got 80 sequences, that's 80-ish updates per SYNC that are
present/absent, which could be a big chunk of what you're seeing.

There are also significant changes in 2.0 in how sl_log_1/2 are trimmed,
which should be helpful.  But I don't expect that's what you're
observing.

> - sometimes after the slave goes offline, or there is a WAN problem,
>   the check_postgres.pl Nagios plug-in (check_slony) reports the slave
>   as lagged, even after the slave and master are both online and can
>   talk to each other -- restarting the slon master and slave resolves this.
>   Otherwise the replication lag time does not decrement / catch up, but
>   falls further behind with the clock.
>
> So do we have a good reason to go to 2.x?  Or should we let it shake out
> a bit longer?

Well, we've kept releasing 2.0.x versions, which hasn't been a good
thing.  But 2.0.5 comes out of having shaken things pretty hard, which
led to >>20 bugs being fixed.  And Steve & Jan have both been running a
lot of tests *after* the committing of all the relevant patches; it has
been two weeks since the last bug fix was committed.

This *should* imply pretty good things for 2.0.5.
-- 
output = reverse("ofni.sailifa.ac" "@" "enworbbc")
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From vivek at khera.org  Thu Oct  7 13:01:41 2010
From: vivek at khera.org (Vick Khera)
Date: Thu, 7 Oct 2010 16:01:41 -0400
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
In-Reply-To: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
Message-ID: <AANLkTik0YiGY8rK9_GbL5rX9tmj88QWSEX4Kkm01qTFt@mail.gmail.com>

On Thu, Oct 7, 2010 at 2:08 PM, Aleksey Tsalolikhin
<atsaloli.tech at gmail.com> wrote:
> I see it doing about 890 ?inserts per second, and same again for
> ? deletes. ? that's 1780 SQL ops per second.
>
> ? By comparison, updates (and slony does not use updates AFAIK so this is
> ? my application's queries) run about 20 updates per second.
>

How many rows are affected per update?  Slony replicates each row
specifically, not the queries themselves.  So if you update 10000
rows, there will be 10000 records for slony to copy over to the other
end.

Naturally running slony replication will be slower because it uses a
log table to track changes, and fires off at least one trigger per row
insert/update/delete to track the changes.

From devrim at gunduz.org  Thu Oct  7 14:31:14 2010
From: devrim at gunduz.org (Devrim =?ISO-8859-1?Q?G=DCND=DCZ?=)
Date: Fri, 08 Oct 2010 00:31:14 +0300
Subject: [Slony1-general] [GENERAL] [ANNOUNCE] Slony-I 2.0.5 Released
In-Reply-To: <7E5CF3E40F594CCDB4AA4E245476A313@chrisPC>
References: <4CADFC1E.7010400@ca.afilias.info>
	<7E5CF3E40F594CCDB4AA4E245476A313@chrisPC>
Message-ID: <1286487074.6760.23.camel@hp-laptop02.gunduz.org>

On Thu, 2010-10-07 at 17:18 -0400, Chris Saunders wrote:
> The link 
> http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2 gives 
> me a 404, NOT FOUND error.


Works for me?
-- 
Devrim G?ND?Z
PostgreSQL Dan??man?/Consultant, Red Hat Certified Engineer
PostgreSQL RPM Repository: http://yum.pgrpms.org
Community: devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
http://www.gunduz.org  Twitter: http://twitter.com/devrimgunduz
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20101008/abca9aa5/attachment.pgp 

From evas at mountaincable.net  Thu Oct  7 14:18:23 2010
From: evas at mountaincable.net (Chris Saunders)
Date: Thu, 7 Oct 2010 17:18:23 -0400
Subject: [Slony1-general] [ANNOUNCE] Slony-I 2.0.5 Released
In-Reply-To: <4CADFC1E.7010400@ca.afilias.info>
References: <4CADFC1E.7010400@ca.afilias.info>
Message-ID: <7E5CF3E40F594CCDB4AA4E245476A313@chrisPC>

The link 
http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2 gives 
me a 404, NOT FOUND error.

Regards
Chris Saunders

--------------------------------------------------
From: "Steve Singer" <ssinger at ca.afilias.info>
Sent: Thursday, October 07, 2010 12:58 PM
To: "slony1-general" <slony1-general at lists.slony.info>; 
<pgsql-general at postgresql.org>; <pgsql-announce at postgresql.org>
Subject: [ANNOUNCE] Slony-I 2.0.5 Released

> The Slony team is pleased to announce the release of version 2.0.5 of the 
> Slony-1 replication system.
>
>
> The release is available at
>
> http://www.slony.info/downloads/2.0/source/slony1-2.0.5.tar.bz2
> http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2
>
>
> 2.0.5 fixes more than 24 issues found from 2.0.4 and earlier versions, 
> remedying many issues found during an extensive testing period.
>
> The following issues visibly change Slony-I behaviour, and thus warrant 
> extra attention from existing users:
>
> -Bug #121 SUBSCRIBE SET is now submitted against the set origin not the 
> provider.
> -Bug #40 Slony now requires a thread-safe libpq  on all platforms.
>
>
> See the release notes (RELEASE file) for more details and a complete list 
> of changes.
>
> ---------------------------(end of broadcast)---------------------------
> -To unsubscribe from this list, send an email to:
>
>               pgsql-announce-unsubscribe at postgresql.org 


From bhirt at me.com  Thu Oct  7 15:21:45 2010
From: bhirt at me.com (Brian Hirt)
Date: Thu, 07 Oct 2010 16:21:45 -0600
Subject: [Slony1-general] Documentation Update
Message-ID: <A4A6E667-4DC2-4051-99BA-F2281F9E1258@me.com>


So I was following the documentation at http://www.slony.info/documentation/2.0/failover.html and couldn't figure out why i couldn't switch over.   I kept getting an error about node -1. I found http://www.slony.info/documentation/2.0/stmtwaitevent.html which says "In version 2.0, the default value for WAIT ON was removed, so a node must be specified."  Adding wait on solved the 
problem.

Something else I noticed is that tools/altperl/slonik_move_set.pl does this with slightly different commands, it does:

lock set (id = 1, origin = 1);
sync (id = 1);
wait for event (origin = 1, confirmed = 2, wait on = 2);
move set (id = 1, old origin = 1, new origin = 2);

whereas the example in the documentation does:

lock set (id = 1, origin = 1);
move set (id = 1, old origin = 1, new origin = 2);
wait for event (origin = 1, confirmed = 2);

I'm not sure if sync() is required, but I'm using sync() in my scripts, it seems to make sense.  I'm also doing a wait for event after the move set.   Something else that might be helpful is showing how to switch back.  It's not immediately obvious which node ids should be used for the wait for event commands.  I think the opposite would be:

lock set (id = 1, origin = 2);
sync (id = 2);
wait for event (origin = 2, confirmed = 1, wait on = 1);
move set (id = 1, old origin = 2, new origin = 1);
wait for event (origin = 2, confirmed = 1);

Thanks,
Brian

From rod at iol.ie  Thu Oct  7 15:22:35 2010
From: rod at iol.ie (Raymond O'Donnell)
Date: Thu, 07 Oct 2010 23:22:35 +0100
Subject: [Slony1-general] [ANNOUNCE] Slony-I 2.0.5 Released
In-Reply-To: <7E5CF3E40F594CCDB4AA4E245476A313@chrisPC>
References: <4CADFC1E.7010400@ca.afilias.info>
	<7E5CF3E40F594CCDB4AA4E245476A313@chrisPC>
Message-ID: <4CAE482B.2060002@iol.ie>

On 07/10/2010 22:18, Chris Saunders wrote:
> The link
> http://www.slony.info/downloads/2.0/source/slony1-2.0.5.docs.tar.bz2 gives
> me a 404, NOT FOUND error.
>

Works OK for me.

Ray.

-- 
Raymond O'Donnell :: Galway :: Ireland
rod at iol.ie

From ssinger at ca.afilias.info  Thu Oct  7 18:41:23 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Thu, 07 Oct 2010 21:41:23 -0400
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
In-Reply-To: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
Message-ID: <4CAE76C3.3070901@ca.afilias.info>

On 10-10-07 02:08 PM, Aleksey Tsalolikhin wrote:

> - sometimes after the slave goes offline, or there is a WAN problem,
>    the check_postgres.pl Nagios plug-in (check_slony) reports the slave
>    as lagged, even after the slave and master are both online and can
>    talk to each other -- restarting the slon master and slave resolves this.
>    Otherwise the replication lag time does not decrement / catch up, but
>    falls further behind with the clock.

This is sounds like bug # 126 
(http://bugs.slony.info/bugzilla/show_bug.cgi?id=126).  This issue is 
still present in 2.0.5


>
> Best,
> Aleksey
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From stefano.bonnin at gmail.com  Fri Oct  8 00:34:55 2010
From: stefano.bonnin at gmail.com (stefano bonnin)
Date: Fri, 8 Oct 2010 09:34:55 +0200
Subject: [Slony1-general] Slony-I configuration with a large number of tables
Message-ID: <AANLkTinZveX1F2p9XmS6+NFXsD4zDrK1P7atsD8RxL5N@mail.gmail.com>

Hi, I have to use slony in order to upgrade my 8.4.5 version to 9.0.1.
I never used slony. My database have a lot of tables and I'd like to know a
fast way for configuring slony in this case. have I to insert all tables in
the configuration file? or there is a fast way in order to achieve this
(something like myschema.* or mydatabase.*)

thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101008/d3aab053/attachment.htm 

From ssinger at ca.afilias.info  Fri Oct  8 07:02:39 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Fri, 08 Oct 2010 10:02:39 -0400
Subject: [Slony1-general] Documentation Update
In-Reply-To: <A4A6E667-4DC2-4051-99BA-F2281F9E1258@me.com>
References: <A4A6E667-4DC2-4051-99BA-F2281F9E1258@me.com>
Message-ID: <4CAF247F.10808@ca.afilias.info>

On 10-10-07 06:21 PM, Brian Hirt wrote:
>
> So I was following the documentation at http://www.slony.info/documentation/2.0/failover.html and couldn't figure out why i couldn't switch over.   I kept getting an error about node -1. I found http://www.slony.info/documentation/2.0/stmtwaitevent.html which says "In version 2.0, the default value for WAIT ON was removed, so a node must be specified."  Adding wait on solved the
> problem.

Thanks I've committed a change to the documentation to address this.

I put the example as "wait on=1" but "wait on=2" will work as well. 
With waiting on 2 you will wait only wait until node 2 (the new origin) 
has processed the move set.  With "wait on=1" you will wait until the 
confirmation has flowed from node 2 to node 1.


>
> Something else I noticed is that tools/altperl/slonik_move_set.pl does this with slightly different commands, it does:
>
> lock set (id = 1, origin = 1);
> sync (id = 1);
> wait for event (origin = 1, confirmed = 2, wait on = 2);
> move set (id = 1, old origin = 1, new origin = 2);
>
> whereas the example in the documentation does:
>
> lock set (id = 1, origin = 1);
> move set (id = 1, old origin = 1, new origin = 2);
> wait for event (origin = 1, confirmed = 2);
>
> I'm not sure if sync() is required, but I'm using sync() in my scripts, it seems to make sense.  I'm also doing a wait for event after the move set.   Something else that might be helpful is showing how to switch back.  It's not immediately obvious which node ids should be used for the wait for event commands.  I think the opposite would be:


I don't think the sync is required after the lock set.

What we might want to consider is

move set (id = 1, old origin = 1, new origin = 2);
wait for event (origin = 1, confirmed = 2, wait on=2);
sync(id=2)
wait for event(origin=2,confirmed=all,wait on=2);

once the 'move set' has been confirmed on the new origin it means that 
the new origin knows that is now the origin and will start accepting 
updates.   The other nodes in the system won't yet know that the origin 
has changed.  As part of processing the move set on the new origin the 
new origin will post an ACCEPT_SET to everyone else.

It sort of depends what you want to do after the move set. If all you 
want to know is when is it safe to start applying traffic to the new 
origin then what is in the documentation is fine.  If you want to wait 
until all move set related activities are done then you need the extra 
sync/wait for combination.


>
> lock set (id = 1, origin = 2);
> sync (id = 2);
> wait for event (origin = 2, confirmed = 1, wait on = 1);
> move set (id = 1, old origin = 2, new origin = 1);
> wait for event (origin = 2, confirmed = 1);

This is fine to move things back (other than your missing the 'wait on' 
in the last wait for event.




>
> Thanks,
> Brian
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From greg at endpoint.com  Fri Oct  8 07:18:36 2010
From: greg at endpoint.com (Greg Sabino Mullane)
Date: Fri, 8 Oct 2010 10:18:36 -0400
Subject: [Slony1-general] Broken web links
Message-ID: <20101008141835.GR12158@core.home>

Could we get some redirect magic going for slony.info? 
Google has tons of links that are now 404; an automatic 
redirect (especially one that teaches Google) or a resurrection 
of the pages would be very helpful. For an example, google 
"sl_event" and click on the first result.

-- 
Greg Sabino Mullane greg at endpoint.com
End Point Corporation
PGP Key: 0x14964AC8
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 163 bytes
Desc: not available
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20101008/afcb5ae1/attachment.pgp 

From ssinger at ca.afilias.info  Fri Oct  8 07:27:12 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Fri, 08 Oct 2010 10:27:12 -0400
Subject: [Slony1-general] Broken web links
In-Reply-To: <20101008141835.GR12158@core.home>
References: <20101008141835.GR12158@core.home>
Message-ID: <4CAF2A40.8010002@ca.afilias.info>

On 10-10-08 10:18 AM, Greg Sabino Mullane wrote:
> Could we get some redirect magic going for slony.info?
> Google has tons of links that are now 404; an automatic
> redirect (especially one that teaches Google) or a resurrection
> of the pages would be very helpful. For an example, google
> "sl_event" and click on the first result.
>
>

done (I think).

I should have been more careful when I modified the website script to 
have direct navigation to multiple versions of the website to make sure 
old unversioned links still default to the current one.

pages that no longer exist in the new documentation either because of 
the reorg or for some of the functions that no longer exist still won't 
work but I don't think that is what you were complaining about.


>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From vivek at khera.org  Fri Oct  8 07:47:46 2010
From: vivek at khera.org (Vick Khera)
Date: Fri, 8 Oct 2010 10:47:46 -0400
Subject: [Slony1-general] Slony-I configuration with a large number of
	tables
In-Reply-To: <AANLkTinZveX1F2p9XmS6+NFXsD4zDrK1P7atsD8RxL5N@mail.gmail.com>
References: <AANLkTinZveX1F2p9XmS6+NFXsD4zDrK1P7atsD8RxL5N@mail.gmail.com>
Message-ID: <AANLkTi=tJNN6uNgpjQoSZr_L_VFyxK5LZvNvJBt=45t=@mail.gmail.com>

On Fri, Oct 8, 2010 at 3:34 AM, stefano bonnin <stefano.bonnin at gmail.com> wrote:
> Hi, I have to use slony in order to upgrade my 8.4.5 version to 9.0.1.
> I never used slony. My database have a lot of tables and I'd like to know a
> fast way for configuring slony in this case. have I to insert all tables in
> the configuration file? or there is a fast way in order to achieve this
> (something like myschema.* or mydatabase.*)

You have to insert them all into the config file.  However nothing is
forcing you to do that manually.  Write a script (or find one online)
that will generate the config file for you by inspecting your schema.
I often use the output of the \d psql command and feed it into a short
perl script to generate the repetitive bits.

From singh.gurjeet at gmail.com  Fri Oct  8 11:14:59 2010
From: singh.gurjeet at gmail.com (Gurjeet Singh)
Date: Fri, 8 Oct 2010 14:14:59 -0400
Subject: [Slony1-general] Slonik uninstall node
Message-ID: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>

Slony version 2.0.3

I have a 2 node Slony cluster and I wish to cleanup everything (manually) if
it is detected that one of the nodes has failed.

So, is just stopping the slon daemons and then executing 'uninstall node'
for the remaining node enough to clean up everything?

$ ./slon_kill

$ ( ./slonik_print_preamble && echo 'uninstall node ( id = 2 ); ' ) | slonik

I looked at slonik.c;slonik_uninstall_node() and _cluster_name.uninstallNode()
plpgsql function, all I could notice is that slonik_uninstall_node() calls
the plpgsql function and then issues 'drop schema _cluster_name cascade;'.
The plpgsql function just issues a 'lock table
_cluster_name.sl_config_lock'.

So I don't see a problem in performing the above 2 commands to clean up and
then configure replication setup from scratch.

Any objections?

Regards,
-- 
gurjeet.singh
@ EnterpriseDB - The Enterprise Postgres Company
http://www.EnterpriseDB.com

singh.gurjeet@{ gmail | yahoo }.com
Twitter/Skype: singh_gurjeet

Mail sent from my BlackLaptop device
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101008/09972df7/attachment.htm 

From scott.marlowe at gmail.com  Fri Oct  8 15:31:21 2010
From: scott.marlowe at gmail.com (Scott Marlowe)
Date: Fri, 8 Oct 2010 16:31:21 -0600
Subject: [Slony1-general] Slonik uninstall node
In-Reply-To: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>
References: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>
Message-ID: <AANLkTinkJ7t6kiw0eL+Hde+K2qjEDWhcoHi_3UhiDObn@mail.gmail.com>

On Fri, Oct 8, 2010 at 12:14 PM, Gurjeet Singh <singh.gurjeet at gmail.com> wrote:
> Slony version 2.0.3
>
> I have a 2 node Slony cluster and I wish to cleanup everything (manually) if
> it is detected that one of the nodes has failed.
>
> So, is just stopping the slon daemons and then executing 'uninstall node'
> for the remaining node enough to clean up everything?

You can leave the daemons running and just drop node.  You might need
to reshape your cluster if the failed node was between two nodes.

From scott.marlowe at gmail.com  Fri Oct  8 15:32:36 2010
From: scott.marlowe at gmail.com (Scott Marlowe)
Date: Fri, 8 Oct 2010 16:32:36 -0600
Subject: [Slony1-general] Slonik uninstall node
In-Reply-To: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>
References: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>
Message-ID: <AANLkTikzHLGbQksmVhs1zFe6GtZTrXw5yr-GzOk63ZjD@mail.gmail.com>

Didn't notice til I'd replied that you were hitting > 1 group.  This
isn't really a discussion worthy of -hackers, -general will do just
fine.

On Fri, Oct 8, 2010 at 12:14 PM, Gurjeet Singh <singh.gurjeet at gmail.com> wrote:
> Slony version 2.0.3
>
> I have a 2 node Slony cluster and I wish to cleanup everything (manually) if
> it is detected that one of the nodes has failed.
>
> So, is just stopping the slon daemons and then executing 'uninstall node'
> for the remaining node enough to clean up everything?
>
> $ ./slon_kill
>
> $ ( ./slonik_print_preamble && echo 'uninstall node ( id = 2 ); ' ) | slonik
>
> I looked at slonik.c;slonik_uninstall_node() and
> _cluster_name.uninstallNode() plpgsql function, all I could notice is that
> slonik_uninstall_node() calls the plpgsql function and then issues 'drop
> schema _cluster_name cascade;'. The plpgsql function just issues a 'lock
> table _cluster_name.sl_config_lock'.
>
> So I don't see a problem in performing the above 2 commands to clean up and
> then configure replication setup from scratch.
>
> Any objections?
>
> Regards,
> --
> gurjeet.singh
> @ EnterpriseDB - The Enterprise Postgres Company
> http://www.EnterpriseDB.com
>
> singh.gurjeet@{ gmail | yahoo }.com
> Twitter/Skype: singh_gurjeet
>
> Mail sent from my BlackLaptop device
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general
>
>



-- 
To understand recursion, one must first understand recursion.

From singh.gurjeet at gmail.com  Fri Oct  8 18:09:47 2010
From: singh.gurjeet at gmail.com (Gurjeet Singh)
Date: Fri, 8 Oct 2010 21:09:47 -0400
Subject: [Slony1-general] Slonik uninstall node
In-Reply-To: <AANLkTikzHLGbQksmVhs1zFe6GtZTrXw5yr-GzOk63ZjD@mail.gmail.com>
References: <AANLkTimxgVRH9HfzWzE9OvYaDjKFELLz5_m6WQ=ZW-3T@mail.gmail.com>
	<AANLkTikzHLGbQksmVhs1zFe6GtZTrXw5yr-GzOk63ZjD@mail.gmail.com>
Message-ID: <AANLkTi=-AUpXayya1QThGjdRQ=C2y13JE85iN3+CabWN@mail.gmail.com>

On Fri, Oct 8, 2010 at 6:32 PM, Scott Marlowe <scott.marlowe at gmail.com>wrote:

> Didn't notice til I'd replied that you were hitting > 1 group.  This
> isn't really a discussion worthy of -hackers, -general will do just
> fine.
>
>
In the OP I had referred to internal functions, hence thought -hackers would
be appropriate too.

Regards,
-- 
gurjeet.singh
@ EnterpriseDB - The Enterprise Postgres Company
http://www.EnterpriseDB.com

singh.gurjeet@{ gmail | yahoo }.com
Twitter/Skype: singh_gurjeet

Mail sent from my BlackLaptop device
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101008/2bddd633/attachment.htm 

From raagavendra.rao at gmail.com  Sat Oct  9 03:04:06 2010
From: raagavendra.rao at gmail.com (raghavendra t)
Date: Sat, 9 Oct 2010 15:34:06 +0530
Subject: [Slony1-general] How to Call another text file in slon_tools.conf
	file ?
Message-ID: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>

Hi All,

I am using slony with perltools.

I have taken the sample file from the
"/usr/local/src/slony1-2.0.4/tools/altperl/slon_tools.conf-sample" and
modified as per my requirement.

*Question*

In the place of Tables list/Sequenst list. Can I use any text file which
contain all the tables information. If yes, how could I pass the test file
to the "slon_tools.conf-sample".

My Testing
========
1. Created a tables file "tab.txt" with set of replicating primary key
tables.

2. Edited the "slon_tools.conf-sample" and trying to send the "tab.txt"
file. Below is the "slon_tools.conf-sample" file I am trying to use

$CLUSTER_NAME = 'firstreplic';
$LOGDIR = '/var/log/slony';
$MASTERNODE = 1;
$DEBUGLEVEL = 2;
*$TABLEFILE = '/usr/local/pgsql/bin/tab.txt';*

&add_node(node => 1,host => 'localhost',dbname => 'master',port => 5455,user
=> 'postgres',password => '');
&add_node(node => 2,host => 'localhost',dbname => 'slave',port => 5456,user
=> 'postgres',password => '');

$SLONY_SETS =
{
    "set1" =>
    {
        "set_id" => 1,
        "table_id" => 1,
        "pkeyedtables" =>
                       * [$TABLEFILE,],*
    }
};

Kindly assist me, how to achieve this task.

Best Regards

Raghav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101009/2c19a33e/attachment.htm 

From ssinger_pg at sympatico.ca  Sat Oct  9 14:49:45 2010
From: ssinger_pg at sympatico.ca (Steve Singer)
Date: Sat, 9 Oct 2010 17:49:45 -0400
Subject: [Slony1-general] How to Call another text file in
 slon_tools.conf file ?
In-Reply-To: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>
References: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>
Message-ID: <BLU0-SMTP871BCE7A4885F8E8B12661AC510@phx.gbl>

raghavendra t wrote:
> Hi All,
> 
> I am using slony with perltools.
> 
> I have taken the sample file from the 
> "/usr/local/src/slony1-2.0.4/tools/altperl/slon_tools.conf-sample" and 
> modified as per my requirement.
> 
> _Question_
> 
> In the place of Tables list/Sequenst list. Can I use any text file which 
> contain all the tables information. If yes, how could I pass the test 
> file to the "slon_tools.conf-sample".

Yes, slon_tools.conf is a perl script, the slon_tools run the .conf file 
as a perl script and execute the code in it.

So you can just write perl code inside of the conf file to open up your 
file and read it into a variable.

I have not tested/tried to run the below code so there might be a syntax 
error or other problems but it should give you the general idea.

> 
> My Testing
> ========
> 1. Created a tables file "tab.txt" with set of replicating primary key 
> tables.
> 
> 2. Edited the "slon_tools.conf-sample" and trying to send the "tab.txt" 
> file. Below is the "slon_tools.conf-sample" file I am trying to use
> 
> $CLUSTER_NAME = 'firstreplic';
> $LOGDIR = '/var/log/slony';
> $MASTERNODE = 1;
> $DEBUGLEVEL = 2;
> *$TABLEFILE = '/usr/local/pgsql/bin/tab.txt';*
> 
> &add_node(node => 1,host => 'localhost',dbname => 'master',port => 
> 5455,user => 'postgres',password => '');
> &add_node(node => 2,host => 'localhost',dbname => 'slave',port => 
> 5456,user => 'postgres',password => '');

open(INFILE,"<$TABLEFILE");
my $tables='';
while(<INFILE>) {

{
    $line = chomp $_;
    $tables+=$line;
}

> 
> $SLONY_SETS =
> {
>     "set1" =>
>     {
>         "set_id" => 1,
>         "table_id" => 1,
>         "pkeyedtables" =>
>                        * [$TABLEFILE,],*
pkeytables=>$tables  #(replace the above line with this one)
>     }
> };
> 
> Kindly assist me, how to achieve this task.
> 
> Best Regards
> 
> Raghav
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From raagavendra.rao at gmail.com  Sat Oct  9 20:11:45 2010
From: raagavendra.rao at gmail.com (raghavendra t)
Date: Sun, 10 Oct 2010 08:41:45 +0530
Subject: [Slony1-general] How to Call another text file in
 slon_tools.conf file ?
In-Reply-To: <BLU0-SMTP871BCE7A4885F8E8B12661AC510@phx.gbl>
References: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>
	<BLU0-SMTP871BCE7A4885F8E8B12661AC510@phx.gbl>
Message-ID: <AANLkTimGBwaGnEAx=rGOG7pDHFxjjMC3o7Xu19oHcN71@mail.gmail.com>

Thank you Steve,

Let me work and get back with the result.

Regards
Raghav

On Sun, Oct 10, 2010 at 3:19 AM, Steve Singer <ssinger_pg at sympatico.ca>wrote:

> raghavendra t wrote:
>
>> Hi All,
>>
>> I am using slony with perltools.
>>
>> I have taken the sample file from the
>> "/usr/local/src/slony1-2.0.4/tools/altperl/slon_tools.conf-sample" and
>> modified as per my requirement.
>>
>> _Question_
>>
>> In the place of Tables list/Sequenst list. Can I use any text file which
>> contain all the tables information. If yes, how could I pass the test file
>> to the "slon_tools.conf-sample".
>>
>
> Yes, slon_tools.conf is a perl script, the slon_tools run the .conf file as
> a perl script and execute the code in it.
>
> So you can just write perl code inside of the conf file to open up your
> file and read it into a variable.
>
> I have not tested/tried to run the below code so there might be a syntax
> error or other problems but it should give you the general idea.
>
>
>
>> My Testing
>> ========
>> 1. Created a tables file "tab.txt" with set of replicating primary key
>> tables.
>>
>> 2. Edited the "slon_tools.conf-sample" and trying to send the "tab.txt"
>> file. Below is the "slon_tools.conf-sample" file I am trying to use
>>
>> $CLUSTER_NAME = 'firstreplic';
>> $LOGDIR = '/var/log/slony';
>> $MASTERNODE = 1;
>> $DEBUGLEVEL = 2;
>> *$TABLEFILE = '/usr/local/pgsql/bin/tab.txt';*
>>
>> &add_node(node => 1,host => 'localhost',dbname => 'master',port =>
>> 5455,user => 'postgres',password => '');
>> &add_node(node => 2,host => 'localhost',dbname => 'slave',port =>
>> 5456,user => 'postgres',password => '');
>>
>
> open(INFILE,"<$TABLEFILE");
> my $tables='';
> while(<INFILE>) {
>
> {
>   $line = chomp $_;
>   $tables+=$line;
> }
>
>
>> $SLONY_SETS =
>> {
>>    "set1" =>
>>    {
>>        "set_id" => 1,
>>        "table_id" => 1,
>>        "pkeyedtables" =>
>>                       * [$TABLEFILE,],*
>>
> pkeytables=>$tables  #(replace the above line with this one)
>
>>    }
>> };
>>
>> Kindly assist me, how to achieve this task.
>>
>> Best Regards
>>
>> Raghav
>>
>>
>>
>> ------------------------------------------------------------------------
>>
>> _______________________________________________
>> Slony1-general mailing list
>> Slony1-general at lists.slony.info
>> http://lists.slony.info/mailman/listinfo/slony1-general
>>
>
>


-- 
Best Regards

Raghav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101010/3e0aaecd/attachment.htm 

From singh.gurjeet at gmail.com  Sat Oct  9 20:59:12 2010
From: singh.gurjeet at gmail.com (Gurjeet Singh)
Date: Sat, 9 Oct 2010 23:59:12 -0400
Subject: [Slony1-general] How to Call another text file in
 slon_tools.conf file ?
In-Reply-To: <AANLkTimGBwaGnEAx=rGOG7pDHFxjjMC3o7Xu19oHcN71@mail.gmail.com>
References: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>
	<BLU0-SMTP871BCE7A4885F8E8B12661AC510@phx.gbl>
	<AANLkTimGBwaGnEAx=rGOG7pDHFxjjMC3o7Xu19oHcN71@mail.gmail.com>
Message-ID: <AANLkTikmzK_Dd2kJ-q045npKiok=bZfY5MZ8+D7nYWv7@mail.gmail.com>

On Sat, Oct 9, 2010 at 11:11 PM, raghavendra t <raagavendra.rao at gmail.com>wrote:

> Thank you Steve,
>
> Let me work and get back with the result.
>
> Regards
> Raghav
>
> On Sun, Oct 10, 2010 at 3:19 AM, Steve Singer <ssinger_pg at sympatico.ca>wrote:
>
>> raghavendra t wrote:
>>
>>> Hi All,
>>>
>>> I am using slony with perltools.
>>>
>>> I have taken the sample file from the
>>> "/usr/local/src/slony1-2.0.4/tools/altperl/slon_tools.conf-sample" and
>>> modified as per my requirement.
>>>
>>> _Question_
>>>
>>> In the place of Tables list/Sequenst list. Can I use any text file which
>>> contain all the tables information. If yes, how could I pass the test file
>>> to the "slon_tools.conf-sample".
>>>
>>
>> Yes, slon_tools.conf is a perl script, the slon_tools run the .conf file
>> as a perl script and execute the code in it.
>>
>> So you can just write perl code inside of the conf file to open up your
>> file and read it into a variable.
>>
>> I have not tested/tried to run the below code so there might be a syntax
>> error or other problems but it should give you the general idea.
>>
>>
>>
>>> My Testing
>>> ========
>>> 1. Created a tables file "tab.txt" with set of replicating primary key
>>> tables.
>>>
>>> 2. Edited the "slon_tools.conf-sample" and trying to send the "tab.txt"
>>> file. Below is the "slon_tools.conf-sample" file I am trying to use
>>>
>>> $CLUSTER_NAME = 'firstreplic';
>>> $LOGDIR = '/var/log/slony';
>>> $MASTERNODE = 1;
>>> $DEBUGLEVEL = 2;
>>> *$TABLEFILE = '/usr/local/pgsql/bin/tab.txt';*
>>>
>>> &add_node(node => 1,host => 'localhost',dbname => 'master',port =>
>>> 5455,user => 'postgres',password => '');
>>> &add_node(node => 2,host => 'localhost',dbname => 'slave',port =>
>>> 5456,user => 'postgres',password => '');
>>>
>>
>> open(INFILE,"<$TABLEFILE");
>> my $tables='';
>> while(<INFILE>) {
>>
>> {
>>   $line = chomp $_;
>>   $tables+=$line;
>> }
>>
>>
>>> $SLONY_SETS =
>>> {
>>>    "set1" =>
>>>    {
>>>        "set_id" => 1,
>>>        "table_id" => 1,
>>>        "pkeyedtables" =>
>>>                       * [$TABLEFILE,],*
>>>
>> pkeytables=>$tables  #(replace the above line with this one)
>>
>>>    }
>>> };
>>>
>>> Kindly assist me, how to achieve this task.
>>>
>>>
This is a working code from a setup that I did recently:

"pkeyedtables" => [ eval 'open( fh, "tables"); my $ret; while(<fh>){chomp;
$ret .= "$set_name.$_\|"}; close fh;return split /\|/,$ret;'],

You will need to adapt it to your needs.

Regards,
-- 
gurjeet.singh
@ EnterpriseDB - The Enterprise Postgres Company
http://www.EnterpriseDB.com

singh.gurjeet@{ gmail | yahoo }.com
Twitter/Skype: singh_gurjeet

Mail sent from my BlackLaptop device
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101009/44ab41bc/attachment.htm 

From raagavendra.rao at gmail.com  Mon Oct 11 06:03:49 2010
From: raagavendra.rao at gmail.com (raghavendra t)
Date: Mon, 11 Oct 2010 18:33:49 +0530
Subject: [Slony1-general] How to Call another text file in
 slon_tools.conf file ?
In-Reply-To: <AANLkTikmzK_Dd2kJ-q045npKiok=bZfY5MZ8+D7nYWv7@mail.gmail.com>
References: <AANLkTind=C_Mx+sMkCFn3v3r+FdhwcEuqd_Q7H5No7n3@mail.gmail.com>
	<BLU0-SMTP871BCE7A4885F8E8B12661AC510@phx.gbl>
	<AANLkTimGBwaGnEAx=rGOG7pDHFxjjMC3o7Xu19oHcN71@mail.gmail.com>
	<AANLkTikmzK_Dd2kJ-q045npKiok=bZfY5MZ8+D7nYWv7@mail.gmail.com>
Message-ID: <AANLkTinGwaFjau7Yj0toGU3_-D7QDaoQBpxY0eT1ePCo@mail.gmail.com>

Hi Gurjeet,

Its working ... Thanks you.

Regards
Raghav

On Sun, Oct 10, 2010 at 9:29 AM, Gurjeet Singh <singh.gurjeet at gmail.com>wrote:

> On Sat, Oct 9, 2010 at 11:11 PM, raghavendra t <raagavendra.rao at gmail.com>wrote:
>
>> Thank you Steve,
>>
>> Let me work and get back with the result.
>>
>> Regards
>> Raghav
>>
>> On Sun, Oct 10, 2010 at 3:19 AM, Steve Singer <ssinger_pg at sympatico.ca>wrote:
>>
>>> raghavendra t wrote:
>>>
>>>> Hi All,
>>>>
>>>> I am using slony with perltools.
>>>>
>>>> I have taken the sample file from the
>>>> "/usr/local/src/slony1-2.0.4/tools/altperl/slon_tools.conf-sample" and
>>>> modified as per my requirement.
>>>>
>>>> _Question_
>>>>
>>>> In the place of Tables list/Sequenst list. Can I use any text file which
>>>> contain all the tables information. If yes, how could I pass the test file
>>>> to the "slon_tools.conf-sample".
>>>>
>>>
>>> Yes, slon_tools.conf is a perl script, the slon_tools run the .conf file
>>> as a perl script and execute the code in it.
>>>
>>> So you can just write perl code inside of the conf file to open up your
>>> file and read it into a variable.
>>>
>>> I have not tested/tried to run the below code so there might be a syntax
>>> error or other problems but it should give you the general idea.
>>>
>>>
>>>
>>>> My Testing
>>>> ========
>>>> 1. Created a tables file "tab.txt" with set of replicating primary key
>>>> tables.
>>>>
>>>> 2. Edited the "slon_tools.conf-sample" and trying to send the "tab.txt"
>>>> file. Below is the "slon_tools.conf-sample" file I am trying to use
>>>>
>>>> $CLUSTER_NAME = 'firstreplic';
>>>> $LOGDIR = '/var/log/slony';
>>>> $MASTERNODE = 1;
>>>> $DEBUGLEVEL = 2;
>>>> *$TABLEFILE = '/usr/local/pgsql/bin/tab.txt';*
>>>>
>>>> &add_node(node => 1,host => 'localhost',dbname => 'master',port =>
>>>> 5455,user => 'postgres',password => '');
>>>> &add_node(node => 2,host => 'localhost',dbname => 'slave',port =>
>>>> 5456,user => 'postgres',password => '');
>>>>
>>>
>>> open(INFILE,"<$TABLEFILE");
>>> my $tables='';
>>> while(<INFILE>) {
>>>
>>> {
>>>   $line = chomp $_;
>>>   $tables+=$line;
>>> }
>>>
>>>
>>>> $SLONY_SETS =
>>>> {
>>>>    "set1" =>
>>>>    {
>>>>        "set_id" => 1,
>>>>        "table_id" => 1,
>>>>        "pkeyedtables" =>
>>>>                       * [$TABLEFILE,],*
>>>>
>>> pkeytables=>$tables  #(replace the above line with this one)
>>>
>>>>    }
>>>> };
>>>>
>>>> Kindly assist me, how to achieve this task.
>>>>
>>>>
> This is a working code from a setup that I did recently:
>
> "pkeyedtables" => [ eval 'open( fh, "tables"); my $ret; while(<fh>){chomp;
> $ret .= "$set_name.$_\|"}; close fh;return split /\|/,$ret;'],
>
> You will need to adapt it to your needs.
>
> Regards,
> --
> gurjeet.singh
> @ EnterpriseDB - The Enterprise Postgres Company
> http://www.EnterpriseDB.com
>
> singh.gurjeet@{ gmail | yahoo }.com
> Twitter/Skype: singh_gurjeet
>
> Mail sent from my BlackLaptop device
>



-- 
Best Regards

Raghav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101011/0daf57de/attachment.htm 

From vivek at khera.org  Wed Oct 13 06:30:10 2010
From: vivek at khera.org (Vick Khera)
Date: Wed, 13 Oct 2010 09:30:10 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
Message-ID: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>

The 1.2.21 docs tarball is missing the adminguide/man1 (and man7)
subdirectory, and the man pages within.  Any chance of re-rolling it?
I'm prepping the FreeBSD package and noticed they were missing.  It is
convenient to have man pages. :)

Thanks!

From ssinger at ca.afilias.info  Wed Oct 13 10:34:54 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Wed, 13 Oct 2010 13:34:54 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
Message-ID: <4CB5EDBE.4030001@ca.afilias.info>

On 10-10-13 09:30 AM, Vick Khera wrote:
> The 1.2.21 docs tarball is missing the adminguide/man1 (and man7)
> subdirectory, and the man pages within.  Any chance of re-rolling it?
> I'm prepping the FreeBSD package and noticed they were missing.  It is
> convenient to have man pages. :)
>

I've repackaged 1.2.21 and 2.0.5 to include the man1 and man7 
directories and updated the files on the downloads site.




> Thanks!
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From vivek at khera.org  Wed Oct 13 10:43:57 2010
From: vivek at khera.org (Vick Khera)
Date: Wed, 13 Oct 2010 13:43:57 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <4CB5EDBE.4030001@ca.afilias.info>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
Message-ID: <AANLkTi=DuAm3DWbiiJ53TNMHYE7rcttBGM9CKNAn69TL@mail.gmail.com>

On Wed, Oct 13, 2010 at 1:34 PM, Steve Singer <ssinger at ca.afilias.info> wrote:
> I've repackaged 1.2.21 and 2.0.5 to include the man1 and man7 directories
> and updated the files on the downloads site.
>
thanks!  looks great.

From devrim at gunduz.org  Wed Oct 13 10:54:36 2010
From: devrim at gunduz.org (Devrim =?ISO-8859-1?Q?G=DCND=DCZ?=)
Date: Wed, 13 Oct 2010 20:54:36 +0300
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <4CB5EDBE.4030001@ca.afilias.info>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
Message-ID: <1286992476.5403.10.camel@hp-laptop02.gunduz.org>

On Wed, 2010-10-13 at 13:34 -0400, Steve Singer wrote:

> I've repackaged 1.2.21 and 2.0.5 to include the man1 and man7 
> directories and updated the files on the downloads site.

Now we have 2 different tarballs around having different md5sums, or
so...
-- 
Devrim G?ND?Z
PostgreSQL Dan??man?/Consultant, Red Hat Certified Engineer
PostgreSQL RPM Repository: http://yum.pgrpms.org
Community: devrim~PostgreSQL.org, devrim.gunduz~linux.org.tr
http://www.gunduz.org  Twitter: http://twitter.com/devrimgunduz
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 198 bytes
Desc: This is a digitally signed message part
Url : http://lists.slony.info/pipermail/slony1-general/attachments/20101013/6ca7175b/attachment.pgp 

From ssinger at ca.afilias.info  Wed Oct 13 11:10:32 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Wed, 13 Oct 2010 14:10:32 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <1286992476.5403.10.camel@hp-laptop02.gunduz.org>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>	
	<4CB5EDBE.4030001@ca.afilias.info>
	<1286992476.5403.10.camel@hp-laptop02.gunduz.org>
Message-ID: <4CB5F618.8090208@ca.afilias.info>

On 10-10-13 01:54 PM, Devrim G?ND?Z wrote:
> On Wed, 2010-10-13 at 13:34 -0400, Steve Singer wrote:
>
>> I've repackaged 1.2.21 and 2.0.5 to include the man1 and man7
>> directories and updated the files on the downloads site.
>
> Now we have 2 different tarballs around having different md5sums, or
> so...

Would it be preferable to rename the files to 
slony1-1.2.21-docs.1.tar.gz with requests to the old filename giving a 
not found?


From cbbrowne at ca.afilias.info  Wed Oct 13 14:54:11 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Wed, 13 Oct 2010 17:54:11 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <1286992476.5403.10.camel@hp-laptop02.gunduz.org> ("Devrim
	=?utf-8?B?R8OcTkTDnFoiJ3M=?= message of "Wed,
	13 Oct 2010 20:54:36 +0300")
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
	<1286992476.5403.10.camel@hp-laptop02.gunduz.org>
Message-ID: <87eibt92t8.fsf@cbbrowne.afilias-int.info>

Devrim G?ND?Z <devrim at gunduz.org> writes:
> On Wed, 2010-10-13 at 13:34 -0400, Steve Singer wrote:
>
>> I've repackaged 1.2.21 and 2.0.5 to include the man1 and man7 
>> directories and updated the files on the downloads site.
>
> Now we have 2 different tarballs around having different md5sums, or
> so...

I'm not thrilled with that, but our process of generating the md5sums is
pretty "open"; it's literally a make target.

If we truly want strong checksums, then I think we'd want to formalize
the use of GPG signatures.  That's a bigger step than seems reasonable.

If someone's *really* that concerned about the provenance of the code, I
imagine they might want to check their own copy of the git repo and
generate a tarball themselves, in which case what we produce isn't of
much value anyways.

If someone was really excited about needing to sign everything, then
maybe we should consider that path, but nobody's pointed at it as an
issue thus far...
-- 
let name="cbbrowne" and tld="afilias.info" in name ^ "@" ^ tld;;
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From vivek at khera.org  Thu Oct 14 06:09:33 2010
From: vivek at khera.org (Vick Khera)
Date: Thu, 14 Oct 2010 09:09:33 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <87eibt92t8.fsf@cbbrowne.afilias-int.info>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
	<1286992476.5403.10.camel@hp-laptop02.gunduz.org>
	<87eibt92t8.fsf@cbbrowne.afilias-int.info>
Message-ID: <AANLkTin0vEfHff5mu9hFQpz7CpBmykHRcfjt1YzncGNG@mail.gmail.com>

2010/10/13 Christopher Browne <cbbrowne at ca.afilias.info>:
>> Now we have 2 different tarballs around having different md5sums, or
>> so...
>
> I'm not thrilled with that, but our process of generating the md5sums is
> pretty "open"; it's literally a make target.
>

Well, it plays more to the package building processes, like FreeBSD
ports. When it downloads a tar file, it compares the known SHA256
(and/or MD5 and/or SHA1) checksum to make sure the file is what was
expected.  At this point, the checksums for FreeBSD ports have the new
file, so I'm kinda leaning towards not renaming anything, but I don't
know the effects to others.

From cbbrowne at ca.afilias.info  Thu Oct 14 08:30:55 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Thu, 14 Oct 2010 11:30:55 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <AANLkTin0vEfHff5mu9hFQpz7CpBmykHRcfjt1YzncGNG@mail.gmail.com>
	(Vick Khera's message of "Thu, 14 Oct 2010 09:09:33 -0400")
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
	<1286992476.5403.10.camel@hp-laptop02.gunduz.org>
	<87eibt92t8.fsf@cbbrowne.afilias-int.info>
	<AANLkTin0vEfHff5mu9hFQpz7CpBmykHRcfjt1YzncGNG@mail.gmail.com>
Message-ID: <877hhk94gg.fsf@cbbrowne.afilias-int.info>

Vick Khera <vivek at khera.org> writes:
> 2010/10/13 Christopher Browne <cbbrowne at ca.afilias.info>:
>>> Now we have 2 different tarballs around having different md5sums, or
>>> so...
>>
>> I'm not thrilled with that, but our process of generating the md5sums is
>> pretty "open"; it's literally a make target.
>>
>
> Well, it plays more to the package building processes, like FreeBSD
> ports. When it downloads a tar file, it compares the known SHA256
> (and/or MD5 and/or SHA1) checksum to make sure the file is what was
> expected.  At this point, the checksums for FreeBSD ports have the new
> file, so I'm kinda leaning towards not renaming anything, but I don't
> know the effects to others.

Ah, so BSD ports actually captures the checksum, and uses it.  That's
good to know.  I'm glad that it is being used, and I suppose we ought to
document the dependency.
-- 
"cbbrowne","@","afilias.info"
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From vivek at khera.org  Thu Oct 14 10:57:16 2010
From: vivek at khera.org (Vick Khera)
Date: Thu, 14 Oct 2010 13:57:16 -0400
Subject: [Slony1-general] 1.2.21 doc tarball missing man pages
In-Reply-To: <877hhk94gg.fsf@cbbrowne.afilias-int.info>
References: <AANLkTi=Noxny=64wnLNA+dN27tds0krqa7vL1S3PJNp9@mail.gmail.com>
	<4CB5EDBE.4030001@ca.afilias.info>
	<1286992476.5403.10.camel@hp-laptop02.gunduz.org>
	<87eibt92t8.fsf@cbbrowne.afilias-int.info>
	<AANLkTin0vEfHff5mu9hFQpz7CpBmykHRcfjt1YzncGNG@mail.gmail.com>
	<877hhk94gg.fsf@cbbrowne.afilias-int.info>
Message-ID: <AANLkTimS8wxTzxKZ31FQz+g5+_5A1sEkMwsCtTmzzrgU@mail.gmail.com>

On Thu, Oct 14, 2010 at 11:30 AM, Christopher Browne
<cbbrowne at ca.afilias.info> wrote:
> Ah, so BSD ports actually captures the checksum, and uses it. ?That's
> good to know. ?I'm glad that it is being used, and I suppose we ought to
> document the dependency.
>

FreeBSD ports system does this: download the raw tarball source files,
compare checksums, run configure with appropriate flags for FreeBSD,
compile, and finally install.  All scripted.

The checksums are baked into the recipe by the person making the port.
 In this case, me.

It was this exact mechanism that caught a trojaned OpenSSH source
tarball on one of its official mirrors a few years ago.

From atsaloli.tech at gmail.com  Thu Oct 14 17:58:27 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Thu, 14 Oct 2010 17:58:27 -0700
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
In-Reply-To: <4CAE76C3.3070901@ca.afilias.info>
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
	<4CAE76C3.3070901@ca.afilias.info>
Message-ID: <AANLkTinez=Yjh5zyLo6CH4qS-13j25aUwizKcdajU5p0@mail.gmail.com>

Hi.  Sorry for my late reply - I appreciate your answers.

[I see a 1:89 ratio between SQL UPDATE's and (INSERT's + DELETE's) and
wanted to find out why.]

Dear Christopher:   I've got 21 sequences in my replication set.
Thank you for the vote of confidence in 2.0.5.  Thanks for the data
point that Slony does do SQL UPDATE's.

Dear Steve:  Yes, it sounds like I've run into bug #126.    I don't
really have anything to add to the bug ticket (besides "me too").  If
I can help gather any additional information, please let me know
what...   I'm quite interested in solving this --  we're a small shop
and any time a system is not self-healing, it can mean less sleep for
me.

Dear Vick:  I do understand running slony replication will have SOME overhead.
I just want to understand difference between 1.2 and 2.  If there is a
big difference,
it's a clear argument to move to 2.  Looks like I should do some
testing in our test lab.
And Vick, you asked:

On Thu, Oct 7, 2010 at 1:01 PM, Vick Khera <vivek at khera.org> wrote:
> How many rows are affected per update?  Slony replicates each row
> specifically, not the queries themselves.  So if you update 10000
> rows, there will be 10000 records for slony to copy over to the other
> end.

I have no idea.  I didn't write the queries, but I am (by default) the
DBA.  How
could I tell how many rows are affected per update?  (Feel free to RTFM me
in the write direction.)

Thanks very much,
Aleksey

From vivek at khera.org  Fri Oct 15 07:05:43 2010
From: vivek at khera.org (Vick Khera)
Date: Fri, 15 Oct 2010 10:05:43 -0400
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
In-Reply-To: <AANLkTinez=Yjh5zyLo6CH4qS-13j25aUwizKcdajU5p0@mail.gmail.com>
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
	<4CAE76C3.3070901@ca.afilias.info>
	<AANLkTinez=Yjh5zyLo6CH4qS-13j25aUwizKcdajU5p0@mail.gmail.com>
Message-ID: <AANLkTikfxZeO6bcwq7N09XZ_3qSNkBtpnFWY7uyoj48G@mail.gmail.com>

On Thu, Oct 14, 2010 at 8:58 PM, Aleksey Tsalolikhin
<atsaloli.tech at gmail.com> wrote:
> Dear Vick: ?I do understand running slony replication will have SOME overhead.
> I just want to understand difference between 1.2 and 2. ?If there is a
> big difference,
> it's a clear argument to move to 2. ?Looks like I should do some
> testing in our test lab.

They both use the same basic technique of keeping a log table of
changes.  The big overhead comes from writing that log and running the
slony triggers.  Slony1 2.0 doesn't eliminate that overhead.

> And Vick, you asked:
>
> On Thu, Oct 7, 2010 at 1:01 PM, Vick Khera <vivek at khera.org> wrote:
>> How many rows are affected per update? ?Slony replicates each row
>> specifically, not the queries themselves. ?So if you update 10000
>> rows, there will be 10000 records for slony to copy over to the other
>> end.
>
> I have no idea. ?I didn't write the queries, but I am (by default) the
> DBA. ?How
> could I tell how many rows are affected per update? ?(Feel free to RTFM me
> in the write direction.)
>

You inspect your queries.  Asking your developers may help.

From vishnu.s at nestgroup.net  Fri Oct 15 03:20:19 2010
From: vishnu.s at nestgroup.net (Vishnu S.)
Date: Fri, 15 Oct 2010 15:50:19 +0530
Subject: [Slony1-general] Master slave Replication Problem
Message-ID: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>

Hi,

 

 

I am using slony-2.0.4 with PostgreSQL 8.4 in Windows Xp. I have two
machines -A and B , where A acts as master and B acts as slave. 

The script is like,

cluster name = sql_cluster;

node 1 admin conninfo = 'dbname=postgres host=10.1.28.69 port=5432
user=postgres password=sa123!';

node 2 admin conninfo = 'dbname=postgres host=10.1.28.33 port=5432
user=postgres password=sa123!';

 

init cluster (id = 1, comment = 'Node 1');

 

create set (id = 1, origin = 1, comment = 'Test table');

set add table (set id =1, origin = 1, id = 2,full qualified name =
'public.test', comment = 'Table Test1', Key='test_pkey');

 

store node (id = 2, comment = 'Node 2', event node=1);

store path (server = 1, client = 2,conninfo = 'dbname=postgres
host=10.1.28.69 user=postgres password=sa123!');

store path (server = 2, client = 1, conninfo = 'dbname=postgres
host=10.1.28.33 port=5432 user=postgres password=sa123!');

 

store listen (origin = 1, provider = 1, receiver = 2);

store listen (origin = 2, provider = 2, receiver = 1);

 

When the machine A is failed the slave machine B is promoted to master .
The promotion script is like,

 

cluster name = sql_cluster;

node 1 admin conninfo = 'dbname=postgres host=10.20.30.2 port=5432
user=postgres';

node 2 admin conninfo = 'dbname=postgres host=10.20.30.3 port=5432
user=postgres';

failover (id = 1, backup node = 2);

drop node(id = 1, event node = 2);

 

 

My requirement is that, 

I have to reconnect the Machine A to the replication set, and  then make
the machine A master and Machine B slave. Please help me to create the
script for this.

 

[ when the machine A is connected again, the cluster is already present
in the 'master' database.  When I tried to start the slony service in
Machine A the cluster get removed. How can I subscribe Machine A]

 

 

 

 

 

Thanks & Regards,

Vishnu S

 

***** Confidentiality Statement/Disclaimer *****

This message and any attachments is intended for the sole use of the intended recipient. It may contain confidential information. Any unauthorized use, dissemination or modification is strictly prohibited. If you are not the intended recipient, please notify the sender immediately then delete it from all your systems, and do not copy, use or print. Internet communications are not secure and it is the responsibility of the recipient to make sure that it is virus/malicious code exempt.
The company/sender cannot be responsible for any unauthorized alterations or modifications made to the contents. If you require any form of confirmation of the contents, please contact the company/sender. The company/sender is not liable for any errors or omissions in the content of this message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101015/828da654/attachment.htm 

From cbbrowne at ca.afilias.info  Fri Oct 15 07:51:59 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Fri, 15 Oct 2010 10:51:59 -0400
Subject: [Slony1-general] Master slave Replication Problem
In-Reply-To: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
	(Vishnu S.'s message of "Fri, 15 Oct 2010 15:50:19 +0530")
References: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
Message-ID: <87k4lj7blc.fsf@cbbrowne.afilias-int.info>

"Vishnu S." <vishnu.s at nestgroup.net> writes:
> ***** Confidentiality Statement/Disclaimer *****
>
> This message and any attachments is intended for the sole use of the intended
> recipient. It may contain confidential information. Any unauthorized use,
> dissemination or modification is strictly prohibited. If you are not the
> intended recipient, please notify the sender immediately then delete it from
> all your systems, and do not copy, use or print. Internet communications are
> not secure and it is the responsibility of the recipient to make sure that it
> is virus/malicious code exempt.
> The company/sender cannot be responsible for any unauthorized alterations or
> modifications made to the contents. If you require any form of confirmation of
> the contents, please contact the company/sender. The company/sender is not
> liable for any errors or omissions in the content of this message.

You're likely to find that people are reluctant to answer questions when
your messages have a big long confidentiality disclaimer like this on
them.  Nobody can be certain that they are the "intended recipient" who
is to make sole use of the message.
-- 
let name="cbbrowne" and tld="ca.afilias.info" in String.concat "@" [name;tld];;
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From vivek at khera.org  Fri Oct 15 09:10:36 2010
From: vivek at khera.org (Vick Khera)
Date: Fri, 15 Oct 2010 12:10:36 -0400
Subject: [Slony1-general] Master slave Replication Problem
In-Reply-To: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
References: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
Message-ID: <AANLkTimajwPgsC23dLDpLUVJVNP9RWXXZRFTny5DkU-9@mail.gmail.com>

On Fri, Oct 15, 2010 at 6:20 AM, Vishnu S. <vishnu.s at nestgroup.net> wrote:
> I have to reconnect the Machine A to the replication set, and ?then make the
> machine A master and Machine B slave. Please help me to create the script
> for this.

The answer is the same as what I told you on the postgres users
mailing list yesterday.

From ajs at crankycanuck.ca  Fri Oct 15 09:18:31 2010
From: ajs at crankycanuck.ca (Andrew Sullivan)
Date: Fri, 15 Oct 2010 12:18:31 -0400
Subject: [Slony1-general] Master slave Replication Problem
In-Reply-To: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
References: <D0124DE0373A744CA8192AFA82C83117CD7B4C@mail-4.tvm.nestgroup.net>
Message-ID: <20101015161831.GJ3627@shinkuro.com>

On Fri, Oct 15, 2010 at 03:50:19PM +0530, Vishnu S. wrote:
> 
> [ when the machine A is connected again, the cluster is already present
> in the 'master' database.  When I tried to start the slony service in
> Machine A the cluster get removed. How can I subscribe Machine A]

Once you've failed over (not controlled switchover), machine A is
toast.  You have to treat it as a completely new database system.  So
initialise the database, subscribe it, and so on.  I get the feeling
you're trying to bring A "back online", using the data it already has.
You can't do that.
 
You may tell your legal department that I won't respond to any more of
your questions because I don't like email with stupid, preposterous
legal disclaimers automatically attached at the bottom.  You may
forward this text directly, if you wish.

A

-- 
Andrew Sullivan
ajs at crankycanuck.ca

From atsaloli.tech at gmail.com  Fri Oct 15 13:25:22 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Fri, 15 Oct 2010 13:25:22 -0700
Subject: [Slony1-general] I'm using Slony-I 1.2.20. Should I upgrade to
 1.2.21 or 2.0.5? (Was Re: [GENERAL] Slony-I 2.0.5 Released)
In-Reply-To: <AANLkTikfxZeO6bcwq7N09XZ_3qSNkBtpnFWY7uyoj48G@mail.gmail.com>
References: <AANLkTinpsg_Q_1_woCGbzYYkVjSMXHAkFgd=T5nJ52pt@mail.gmail.com>
	<4CAE76C3.3070901@ca.afilias.info>
	<AANLkTinez=Yjh5zyLo6CH4qS-13j25aUwizKcdajU5p0@mail.gmail.com>
	<AANLkTikfxZeO6bcwq7N09XZ_3qSNkBtpnFWY7uyoj48G@mail.gmail.com>
Message-ID: <AANLkTi=G3ajAg+W2tZjFqEz59TrjiyYGXS69CcZjEVJX@mail.gmail.com>

Dear Vick,

  Thanks for your reply!  :)  I appreciate your help.  I understand
there's overhead with either v1.x or v2.x of Slony-I.  Thank you.  I
also understand I have to drill into my SQL queries to understand how
many rows they impact.

Yours very truly,
Aleksey

From vishnu.s at nestgroup.net  Sun Oct 17 23:50:29 2010
From: vishnu.s at nestgroup.net (Vishnu S.)
Date: Mon, 18 Oct 2010 12:20:29 +0530
Subject: [Slony1-general] Rejoin a master database to replication set.
Message-ID: <D0124DE0373A744CA8192AFA82C83117DAA424@mail-4.tvm.nestgroup.net>

Hi,

 

 

I am using Slony-I 2.0.4 with PostgreSQL 8.4 in windows XP. I have
replicated the data from a master (say A ) to a slave machine(say B).
And when the Master machine A fails, the slave machine B, acts as Master
machine and the node corresponding to master is dropped using  DROP NODE
command. It  also works fine. My requirement is that,

 

I have to rejoin the machine A to the replication set.

Then I have to replicate data from Machine B to Machine A. (ie. Both
machine A and Machine B contains same data.)

The I have to change Machine A as master machine and Master B slave
machine. 

 

 

Please help me to create scripts for this.

 

 

 

Thanks & Regards,

Vishnu S

 

***** Confidentiality Statement/Disclaimer *****

This message and any attachments is intended for the sole use of the intended recipient. It may contain confidential information. Any unauthorized use, dissemination or modification is strictly prohibited. If you are not the intended recipient, please notify the sender immediately then delete it from all your systems, and do not copy, use or print. Internet communications are not secure and it is the responsibility of the recipient to make sure that it is virus/malicious code exempt.
The company/sender cannot be responsible for any unauthorized alterations or modifications made to the contents. If you require any form of confirmation of the contents, please contact the company/sender. The company/sender is not liable for any errors or omissions in the content of this message.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101018/5a9b1717/attachment.htm 

From ajs at crankycanuck.ca  Mon Oct 18 08:10:31 2010
From: ajs at crankycanuck.ca (Andrew Sullivan)
Date: Mon, 18 Oct 2010 11:10:31 -0400
Subject: [Slony1-general] Rejoin a master database to replication set.
In-Reply-To: <D0124DE0373A744CA8192AFA82C83117DAA424@mail-4.tvm.nestgroup.net>
References: <D0124DE0373A744CA8192AFA82C83117DAA424@mail-4.tvm.nestgroup.net>
Message-ID: <20101018151031.GJ10167@shinkuro.com>

I think this question has already been answered for you, more than
once.  If you need more help than that, I am available for consulting
at an hourly rate, as are others on this list.

A

On Mon, Oct 18, 2010 at 12:20:29PM +0530, Vishnu S. wrote:
> Hi,
> 
>  
> 
>  
> 
> I am using Slony-I 2.0.4 with PostgreSQL 8.4 in windows XP. I have
> replicated the data from a master (say A ) to a slave machine(say B).
> And when the Master machine A fails, the slave machine B, acts as Master
> machine and the node corresponding to master is dropped using  DROP NODE
> command. It  also works fine. My requirement is that,
> 
>  
> 
> I have to rejoin the machine A to the replication set.
> 
> Then I have to replicate data from Machine B to Machine A. (ie. Both
> machine A and Machine B contains same data.)
> 
> The I have to change Machine A as master machine and Master B slave
> machine. 
> 
>  
> 
>  
> 
> Please help me to create scripts for this.
> 
>  
> 
>  
> 
>  
> 
> Thanks & Regards,
> 
> Vishnu S
> 
>  
> 
> ***** Confidentiality Statement/Disclaimer *****
> 
> This message and any attachments is intended for the sole use of the intended recipient. It may contain confidential information. Any unauthorized use, dissemination or modification is strictly prohibited. If you are not the intended recipient, please notify the sender immediately then delete it from all your systems, and do not copy, use or print. Internet communications are not secure and it is the responsibility of the recipient to make sure that it is virus/malicious code exempt.
> The company/sender cannot be responsible for any unauthorized alterations or modifications made to the contents. If you require any form of confirmation of the contents, please contact the company/sender. The company/sender is not liable for any errors or omissions in the content of this message.

> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


-- 
Andrew Sullivan
ajs at crankycanuck.ca

From vivek at khera.org  Mon Oct 18 08:13:31 2010
From: vivek at khera.org (Vick Khera)
Date: Mon, 18 Oct 2010 11:13:31 -0400
Subject: [Slony1-general] Rejoin a master database to replication set.
In-Reply-To: <D0124DE0373A744CA8192AFA82C83117DAA424@mail-4.tvm.nestgroup.net>
References: <D0124DE0373A744CA8192AFA82C83117DAA424@mail-4.tvm.nestgroup.net>
Message-ID: <AANLkTikyR0E1crwj+j1kHgu0=wC1FTSbDjH=_MtZHgej@mail.gmail.com>

On Mon, Oct 18, 2010 at 2:50 AM, Vishnu S. <vishnu.s at nestgroup.net> wrote:
> I am using Slony-I 2.0.4 with PostgreSQL 8.4 in windows XP. I have
> replicated the data from a master (say A ) to a slave machine(say B). And
> when the Master machine A fails, the slave machine B, acts as Master machine
> and the node corresponding to master is dropped using ?DROP NODE command. It
> ?also works fine. My requirement is that,

Are you not understanding the answers you've gotten already?  Do you
really think asking the same question to the same people over and over
will get you a different answer?

From atsaloli.tech at gmail.com  Mon Oct 18 12:48:43 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Mon, 18 Oct 2010 12:48:43 -0700
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
	pg_dump is running ON THE SLAVE.
Message-ID: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>

Hi.  Replication lags over 5 minutes behind (sometimes over 10 minutes
behind) while pg_dump is running on the slave.

We monitor our replication lag using Bucardo's check_postgres.pl and
it keeps showing up on the monitoring/alerting radar 4 times a day,
when we do the pg_dump.

I've increased the alert threshold to 30 minutes as an immediate
measure, but is there any way to reduce pg_dump's impact on
replication?  or will we pretty much have to live with it?

Best,
-at

From bench at silentmedia.com  Mon Oct 18 12:54:18 2010
From: bench at silentmedia.com (Ben Chobot)
Date: Mon, 18 Oct 2010 12:54:18 -0700
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
	pg_dump is running ON THE SLAVE.
In-Reply-To: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
Message-ID: <244FA5E5-862A-4A07-84C5-4C39278C29D1@silentmedia.com>

On Oct 18, 2010, at 12:48 PM, Aleksey Tsalolikhin wrote:

> Hi.  Replication lags over 5 minutes behind (sometimes over 10 minutes
> behind) while pg_dump is running on the slave.
> 
> We monitor our replication lag using Bucardo's check_postgres.pl and
> it keeps showing up on the monitoring/alerting radar 4 times a day,
> when we do the pg_dump.
> 
> I've increased the alert threshold to 30 minutes as an immediate
> measure, but is there any way to reduce pg_dump's impact on
> replication?  or will we pretty much have to live with it?

Are you out of i/o bandwidth on the slave?

From ssinger at ca.afilias.info  Mon Oct 18 14:14:25 2010
From: ssinger at ca.afilias.info (Steve Singer)
Date: Mon, 18 Oct 2010 17:14:25 -0400
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
Message-ID: <4CBCB8B1.8080503@ca.afilias.info>

On 10-10-18 03:48 PM, Aleksey Tsalolikhin wrote:
> Hi.  Replication lags over 5 minutes behind (sometimes over 10 minutes
> behind) while pg_dump is running on the slave.
>
> We monitor our replication lag using Bucardo's check_postgres.pl and
> it keeps showing up on the monitoring/alerting radar 4 times a day,
> when we do the pg_dump.
>
> I've increased the alert threshold to 30 minutes as an immediate
> measure, but is there any way to reduce pg_dump's impact on
> replication?  or will we pretty much have to live with it?

Can you exclude the slony schema from your dump?

What might be happening is that the pg_dump obtains a shared read lock 
on the rows in sl_confirm (or sl_config_lock).  pg_dump will hold these 
locks until your backup is complete.

When Slony tries to generate sync events (or any other event) it needs 
an exclusive lock on sl_event to get the ordering right.  This means 
that no new sync events can be generated until after the pg_dump finishes.

This probably needs to be better documented, I was surprised when I 
recently encountered it.  Even the old page on locking issues was silent 
to this http://www.slony.info/documentation/1.2/locking.html

>
> Best,
> -at
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


From atsaloli.tech at gmail.com  Mon Oct 18 16:14:52 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Mon, 18 Oct 2010 16:14:52 -0700
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <4CBCB8B1.8080503@ca.afilias.info>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
	<4CBCB8B1.8080503@ca.afilias.info>
Message-ID: <AANLkTi=TiDgamHFZL9oB-Xc6vRvu5BiE09pU3DS_D6ud@mail.gmail.com>

Dear Steve,

    I've excluded the slony schema from my dump and this did it!

    Excluding the slony schema from the pg_dump allowed replication
lag to stay low (under a minute).   (Even though my disk subsystem was
getting hammered - 100% utilization, per iostat, to answer Ben's
question.)

  Very good, and thank you for the quick help, gentlebeings!  I will
submit a documentation patch.

Sincerely,
Aleksey

From vivek at khera.org  Tue Oct 19 07:18:09 2010
From: vivek at khera.org (Vick Khera)
Date: Tue, 19 Oct 2010 10:18:09 -0400
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
Message-ID: <AANLkTi=jFxAg5A3BbxdE4TBx-iqMfb+dg=L__qisKCYV@mail.gmail.com>

On Mon, Oct 18, 2010 at 3:48 PM, Aleksey Tsalolikhin
<atsaloli.tech at gmail.com> wrote:
> I've increased the alert threshold to 30 minutes as an immediate
> measure, but is there any way to reduce pg_dump's impact on
> replication? ?or will we pretty much have to live with it?
>

Your hardware is approaching the limits of the workload you are
throwing at it.  I'd recommend adding more RAM and/or tuning postgres
to use more of it somehow.  Either that or faster disks, or both.

From bhirt at me.com  Tue Oct 19 10:00:39 2010
From: bhirt at me.com (Brian Hirt)
Date: Tue, 19 Oct 2010 11:00:39 -0600
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <AANLkTi=jFxAg5A3BbxdE4TBx-iqMfb+dg=L__qisKCYV@mail.gmail.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
	<AANLkTi=jFxAg5A3BbxdE4TBx-iqMfb+dg=L__qisKCYV@mail.gmail.com>
Message-ID: <46E0E80E-414C-489C-BD71-AF299D249AA5@me.com>

On Oct 19, 2010, at 8:18 AM, Vick Khera wrote:

> On Mon, Oct 18, 2010 at 3:48 PM, Aleksey Tsalolikhin
> <atsaloli.tech at gmail.com> wrote:
>> I've increased the alert threshold to 30 minutes as an immediate
>> measure, but is there any way to reduce pg_dump's impact on
>> replication?  or will we pretty much have to live with it?
>> 
> 
> Your hardware is approaching the limits of the workload you are
> throwing at it.  I'd recommend adding more RAM and/or tuning postgres
> to use more of it somehow.  Either that or faster disks, or both.
> 

I think the problem is actually the exclusive lock mentioned in the previous post.  Upgrading hardware might make the dump run faster, but it will still block replication.   We've noticed the exact same thing on our systems.

From scott.marlowe at gmail.com  Tue Oct 19 13:51:48 2010
From: scott.marlowe at gmail.com (Scott Marlowe)
Date: Tue, 19 Oct 2010 14:51:48 -0600
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <46E0E80E-414C-489C-BD71-AF299D249AA5@me.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
	<AANLkTi=jFxAg5A3BbxdE4TBx-iqMfb+dg=L__qisKCYV@mail.gmail.com>
	<46E0E80E-414C-489C-BD71-AF299D249AA5@me.com>
Message-ID: <AANLkTiku0TAGkTEDUuo_KA+6J8tQueJED49-u2oaWPjm@mail.gmail.com>

On Tue, Oct 19, 2010 at 11:00 AM, Brian Hirt <bhirt at me.com> wrote:
> On Oct 19, 2010, at 8:18 AM, Vick Khera wrote:
>
>> On Mon, Oct 18, 2010 at 3:48 PM, Aleksey Tsalolikhin
>> <atsaloli.tech at gmail.com> wrote:
>>> I've increased the alert threshold to 30 minutes as an immediate
>>> measure, but is there any way to reduce pg_dump's impact on
>>> replication? ?or will we pretty much have to live with it?
>>>
>>
>> Your hardware is approaching the limits of the workload you are
>> throwing at it. ?I'd recommend adding more RAM and/or tuning postgres
>> to use more of it somehow. ?Either that or faster disks, or both.
>>
>
> I think the problem is actually the exclusive lock mentioned in the previous post. ?Upgrading hardware might make the dump run faster, but it will still block replication. ? We've noticed the exact same thing on our systems.

Yeah, I think you need to look at IO utilization outside of when dumps
are occurring to really say whether or not you're maxing out IO.  Keep
in mind pg_dump is simple copies which can really hammer most IO
subsystems hard, but if you're only using 5% of your IO the rest of
the time then you're probably ok.

-- 
To understand recursion, one must first understand recursion.

From fernandoaguada at gmail.com  Tue Oct 19 16:02:28 2010
From: fernandoaguada at gmail.com (Fernando Aguada)
Date: Tue, 19 Oct 2010 20:02:28 -0300
Subject: [Slony1-general] Error 1057 registering slon service in Windows
	2003 Server
Message-ID: <000501cb6fe1$b6cddaa0$ca00a8c0@FERNANDO>

Hi all,

when trying to register the service I get the following message:
Failed to create service: 1057.

some help?

Best regards

Fernando
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.slony.info/pipermail/slony1-general/attachments/20101019/a49f175a/attachment.htm 

From atsaloli.tech at gmail.com  Wed Oct 20 16:59:57 2010
From: atsaloli.tech at gmail.com (Aleksey Tsalolikhin)
Date: Wed, 20 Oct 2010 16:59:57 -0700
Subject: [Slony1-general] slony-I 1.2.20 replication lags behind when
 pg_dump is running ON THE SLAVE.
In-Reply-To: <AANLkTiku0TAGkTEDUuo_KA+6J8tQueJED49-u2oaWPjm@mail.gmail.com>
References: <AANLkTikQW1JzLvnsLKpdza=wwfyDXwq0pc4t195X7cXF@mail.gmail.com>
	<AANLkTi=jFxAg5A3BbxdE4TBx-iqMfb+dg=L__qisKCYV@mail.gmail.com>
	<46E0E80E-414C-489C-BD71-AF299D249AA5@me.com>
	<AANLkTiku0TAGkTEDUuo_KA+6J8tQueJED49-u2oaWPjm@mail.gmail.com>
Message-ID: <AANLkTinVqO-0J7LSycTH0fY5bY7smB7=K=nHyHMBiqEg@mail.gmail.com>

Hi.  I changed the pg_dump to exclude the slony schema and slony
replication no longer lags during pg_dump.  Thanks!!

Aleksey

From msteben at autorevenue.com  Mon Oct 25 08:44:35 2010
From: msteben at autorevenue.com (Mark Steben)
Date: Mon, 25 Oct 2010 11:44:35 -0400
Subject: [Slony1-general] VMWARE question
Message-ID: <20101025154447.A62B4290D04@main.slony.info>

Hi

We?re running postgres 8.3.11.  Do you have any recommendations
Using a physical server for the master and a vm server for the only slave?
Are there any restrictions / potential gotchas I should be ware of?

MASTER:
   Linux ar-db-psql-1desq 2.6.18-194.11.3.el5 #1 SMP Mon Aug 30 16:19:16 EDT
2010 x86_64 x86_64 x86_64 GNU/Linux
    32 GB total memory

SLAVE
Linux ar-db4 2.6.18-194.8.1.el5 #1 SMP Thu Jul 1 19:04:48 EDT 2010 x86_64
x86_64 x86_64 GNU/Linux
  32 GB total memory    

Thank you,
   
   
Mark Steben?|?Database Administrator?
@utoRevenue? - "Keeping Customers Close"?
95D Ashley Ave, West Springfield, MA 01089 
413.243.4800 x1512 (Phone) |413.732-1824 (Fax) 
@utoRevenue is a registered trademark and a division of Dominion
Enterprises?
?




From ajs at crankycanuck.ca  Mon Oct 25 09:03:32 2010
From: ajs at crankycanuck.ca (Andrew Sullivan)
Date: Mon, 25 Oct 2010 12:03:32 -0400
Subject: [Slony1-general] VMWARE question
In-Reply-To: <20101025154447.A62B4290D04@main.slony.info>
References: <20101025154447.A62B4290D04@main.slony.info>
Message-ID: <20101025160332.GK45134@shinkuro.com>

On Mon, Oct 25, 2010 at 11:44:35AM -0400, Mark Steben wrote:
> We?re running postgres 8.3.11.  Do you have any recommendations
> Using a physical server for the master and a vm server for the only slave?
> Are there any restrictions / potential gotchas I should be ware of?

Test -- really, really test -- the I/O capacity of your vmware target.
My previous (now aged) tests in this area suggested to me that there
was a very serious penalty.  Slony systems are almost always I/O bound
when they get into trouble.

Other than that, it's just another box, AFAICT.

A


-- 
Andrew Sullivan
ajs at crankycanuck.ca

From cbbrowne at ca.afilias.info  Mon Oct 25 08:59:43 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Mon, 25 Oct 2010 11:59:43 -0400
Subject: [Slony1-general] VMWARE question
In-Reply-To: <20101025154447.A62B4290D04@main.slony.info> (Mark Steben's
	message of "Mon, 25 Oct 2010 11:44:35 -0400")
References: <20101025154447.A62B4290D04@main.slony.info>
Message-ID: <87bp6ixnyo.fsf@cbbrowne.afilias-int.info>

"Mark Steben" <msteben at autorevenue.com> writes:
> We?re running postgres 8.3.11.  Do you have any recommendations
> Using a physical server for the master and a vm server for the only slave?
> Are there any restrictions / potential gotchas I should be ware of?
>
> MASTER:
>    Linux ar-db-psql-1desq 2.6.18-194.11.3.el5 #1 SMP Mon Aug 30 16:19:16 EDT
> 2010 x86_64 x86_64 x86_64 GNU/Linux
>     32 GB total memory
>
> SLAVE
> Linux ar-db4 2.6.18-194.8.1.el5 #1 SMP Thu Jul 1 19:04:48 EDT 2010 x86_64
> x86_64 x86_64 GNU/Linux
>   32 GB total memory    

It's typically a safer thing to be using the most generic kind of system
configuration that you can, stipulated that it needs to be "powerful
enough."

Replication, by connecting a bunch of components together, throws in a
pile of complications, so it's nice to have as few *other* complications
as possible.  (IBM HACMP - I'm looking at you!  :-))

Assuming that this hardware has enough "oomph" for what you're planning
to run on it, I don't foresee any particular problems.  While the "VM"
implies a bit of complication, that sort of thing seems to be fairly
under control these days.  

Nothing leaps out at me as being an issue.
-- 
select 'cbbrowne' || '@' || 'afilias.info';
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From cbbrowne at ca.afilias.info  Mon Oct 25 11:26:50 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Mon, 25 Oct 2010 14:26:50 -0400
Subject: [Slony1-general] VMWARE question
In-Reply-To: <20101025160332.GK45134@shinkuro.com> (Andrew Sullivan's message
	of "Mon, 25 Oct 2010 12:03:32 -0400")
References: <20101025154447.A62B4290D04@main.slony.info>
	<20101025160332.GK45134@shinkuro.com>
Message-ID: <874ocaxh5h.fsf@cbbrowne.afilias-int.info>

Andrew Sullivan <ajs at crankycanuck.ca> writes:
> On Mon, Oct 25, 2010 at 11:44:35AM -0400, Mark Steben wrote:
>> We?re running postgres 8.3.11.  Do you have any recommendations
>> Using a physical server for the master and a vm server for the only slave?
>> Are there any restrictions / potential gotchas I should be ware of?
>
> Test -- really, really test -- the I/O capacity of your vmware target.
> My previous (now aged) tests in this area suggested to me that there
> was a very serious penalty.  Slony systems are almost always I/O bound
> when they get into trouble.
>
> Other than that, it's just another box, AFAICT.

And for the most part, none of this has anything to do with Slony, per
se - the issues are surrounding running a database on virtualized
hardware.

The *really* notable issues people have found have involved running
databases "in the cloud," as with products like Amazon EC2.

And I suppose that this fits in somewhat with the Oracle "thing" of
liking to run atop raw disk.  Oracle particularly likes that.  

In contrast, Postgres has always remained agnostic of specific hardware
knowledge, preferring to take advantage of the filesystems improvements
taking place in OS platforms.  Nobody wants to have to take over
implementing filesystems, and such.

But the issues relating to virtualization demonstrate that we're not all
that distant from Oracle; if you put *too* many layers of emulation
between your database and the hardware it's actually using, there's
trouble to be found...
-- 
output = ("cbbrowne" "@" "ca.afilias.info")
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From ole.wendland at werum.de  Tue Oct 26 03:12:28 2010
From: ole.wendland at werum.de (Ole Wendland)
Date: Tue, 26 Oct 2010 12:12:28 +0200
Subject: [Slony1-general] reintegrating a failed master
Message-ID: <4CC6A98C.5010609@werum.de>

Hello,
I installed slony 2.0.4 and postgres 8.4 on Red Hat system and setup-up 
a Slony cluster with 3 nodes, lets call them n1,n2 and n3. Normal 
replication and switch over are working fine.
If the master n1 fails, then I do a failover on n2 and n3 and for them 
life go's on. My troubles starts if I try to reintegrate n1 as slave, on 
startup everything looks fine, than I subscribe him  new  for n2 which 
also looks fine.

"subscribe set ( id = 1, provider = 2, receiver = 1, forward = yes);"

  But when new set arrives at n1 I get following failure.

"select "_smv_ts_rep".setAddTable_int(1, 1, '"public"."role"', 
'role_pkey', 'role table'); " PGRES_FATAL_ERROR FEHLER:  Slony-I: 
setAddTable_int: table id 1 has already been assigned!"

A "REPAIR CONFIG ( SET ID = 1, EVENT NODE = 2);" had no effect on this 
issue.

I guess it is just a small thing which slipped my attention, but I'm 
very gratefully for every advise in this situation.

Greetings

Ole



From stephane.schildknecht at postgresql.fr  Tue Oct 26 05:01:11 2010
From: stephane.schildknecht at postgresql.fr (=?ISO-8859-15?Q?=22St=E9phane_A=2E_Schildknecht=22?=)
Date: Tue, 26 Oct 2010 14:01:11 +0200
Subject: [Slony1-general] reintegrating a failed master
In-Reply-To: <4CC6A98C.5010609@werum.de>
References: <4CC6A98C.5010609@werum.de>
Message-ID: <4CC6C307.2040509@postgresql.fr>

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Le 26/10/2010 12:12, Ole Wendland a ?crit :
> Hello,
> I installed slony 2.0.4 and postgres 8.4 on Red Hat system and setup-up 
> a Slony cluster with 3 nodes, lets call them n1,n2 and n3. Normal 
> replication and switch over are working fine.
> If the master n1 fails, then I do a failover on n2 and n3 and for them 
> life go's on. My troubles starts if I try to reintegrate n1 as slave, on 
> startup everything looks fine, than I subscribe him  new  for n2 which 
> also looks fine.

Did you execute all steps?
uninstall node and then store node ?

Regards,
St?phane Schildknecht
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.10 (GNU/Linux)
Comment: Using GnuPG with Mozilla - http://enigmail.mozdev.org/

iEYEARECAAYFAkzGwwcACgkQA+REPKWGI0Ga9QCgkYc0hfHtzWH4GjAUjQ2bic5N
LXEAoNafoO4BkZzOdovcZXZ/A0gmqORQ
=6K7W
-----END PGP SIGNATURE-----

From vivek at khera.org  Tue Oct 26 05:01:22 2010
From: vivek at khera.org (Vick Khera)
Date: Tue, 26 Oct 2010 08:01:22 -0400
Subject: [Slony1-general] reintegrating a failed master
In-Reply-To: <4CC6A98C.5010609@werum.de>
References: <4CC6A98C.5010609@werum.de>
Message-ID: <AANLkTin6pNy0JJimJTTHOrPB5iBN9Xhvd-ws1f=QXj3X@mail.gmail.com>

On Tue, Oct 26, 2010 at 6:12 AM, Ole Wendland <ole.wendland at werum.de> wrote:
> If the master n1 fails, then I do a failover on n2 and n3 and for them
> life go's on. My troubles starts if I try to reintegrate n1 as slave, on
> startup everything looks fine, than I subscribe him ?new ?for n2 which
> also looks fine.
>

You need to start the node n1 from scratch.  Drop the DB, and recreate
the schema, then add the node as a totally new replica.  Is that what
you did?

From ole.wendland at werum.de  Tue Oct 26 05:56:25 2010
From: ole.wendland at werum.de (Ole Wendland)
Date: Tue, 26 Oct 2010 14:56:25 +0200
Subject: [Slony1-general] reintegrating a failed master
In-Reply-To: <4CC6A98C.5010609@werum.de>
References: <4CC6A98C.5010609@werum.de>
Message-ID: <4CC6CFF9.1030200@werum.de>

Ok thank you guys,
  after really dropping the hole DB it worked. I really hoped that I 
could avoid the step, but this seemed to be an illusion.

Greetings Ole

Am 26.10.2010 12:12, schrieb Ole Wendland:
> Hello,
> I installed slony 2.0.4 and postgres 8.4 on Red Hat system and setup-up
> a Slony cluster with 3 nodes, lets call them n1,n2 and n3. Normal
> replication and switch over are working fine.
> If the master n1 fails, then I do a failover on n2 and n3 and for them
> life go's on. My troubles starts if I try to reintegrate n1 as slave, on
> startup everything looks fine, than I subscribe him  new  for n2 which
> also looks fine.
>
> "subscribe set ( id = 1, provider = 2, receiver = 1, forward = yes);"
>
>    But when new set arrives at n1 I get following failure.
>
> "select "_smv_ts_rep".setAddTable_int(1, 1, '"public"."role"',
> 'role_pkey', 'role table'); " PGRES_FATAL_ERROR FEHLER:  Slony-I:
> setAddTable_int: table id 1 has already been assigned!"
>
> A "REPAIR CONFIG ( SET ID = 1, EVENT NODE = 2);" had no effect on this
> issue.
>
> I guess it is just a small thing which slipped my attention, but I'm
> very gratefully for every advise in this situation.
>
> Greetings
>
> Ole
>
>
> _______________________________________________
> Slony1-general mailing list
> Slony1-general at lists.slony.info
> http://lists.slony.info/mailman/listinfo/slony1-general


-- 
Ole Wendland, Dipl.-Ing. (FH) M. Sc.
Software Engineer
CIS (Communication&  Information Systems)
Werum Software&  Systems AG
Wulf-Werum-Stra?e 3 | 21337 L?neburg
Tel. +49(0)4131/8900-393 | Fax +49(0)4131/8900-20
mailto:ole.wendland at werum.de | http://www.werum.de

USt-ID-Nr. DE 116 083 850 | RG L?neburg HRB 2262
Vorsitzender des Aufsichtsrats: Johannes Zimmermann
Vorstand: Hartmut Krome, R?diger Schlierenk?mper, Hans-Peter Subel


From cbbrowne at ca.afilias.info  Tue Oct 26 08:06:25 2010
From: cbbrowne at ca.afilias.info (Christopher Browne)
Date: Tue, 26 Oct 2010 11:06:25 -0400
Subject: [Slony1-general] reintegrating a failed master
In-Reply-To: <4CC6CFF9.1030200@werum.de> (Ole Wendland's message of "Tue, 26
	Oct 2010 14:56:25 +0200")
References: <4CC6A98C.5010609@werum.de> <4CC6CFF9.1030200@werum.de>
Message-ID: <87tyk9vvri.fsf@cbbrowne.afilias-int.info>

Ole Wendland <ole.wendland at werum.de> writes:
> Ok thank you guys,
>   after really dropping the hole DB it worked. I really hoped that I 
> could avoid the step, but this seemed to be an illusion.

Sorry, yes, it's an illusion to think you can avoid rebuilding.

You don't necessarily need to drop the whole database - the scenario
where that's truly needful is where there was a corruption (e.g. - bad
disk, bad memory, or such, corrupting the database).  

In contrast, if the reason for the failover was a network outage, then
there's no reason to believe that the database is actually corrupted,
and it should suffice to drop replication (e.g. - DROP NODE, or DROP
SCHEMA "_WhaTeVER" CASCADE), and rebuild.

(If there was a hardware corruption, I'd be inclined to go further than
merely dropping the database - I'd want to scrape things down to the
filesystem level, and start over with "mkfs" as one of the first
steps...)

In any case, there is no way to reintegrate the failed master, as it may
have state committed on it that was never replicated, and there's no way
for Slony-I to account for that.  

Perhaps there's none of that, in a particular situation, perhaps one
might imagine it OK to try, but we didn't put this "perhaps" into the
implementation, as we didn't think that "perhaps you don't care about
your data that much" represented a wonderful feature.
-- 
output = ("cbbrowne" "@" "afilias.info")
Christopher Browne
"Bother,"  said Pooh,  "Eeyore, ready  two photon  torpedoes  and lock
phasers on the Heffalump, Piglet, meet me in transporter room three"

From Ger.Timmens at adyen.com  Sun Oct 31 01:55:05 2010
From: Ger.Timmens at adyen.com (Ger Timmens)
Date: Sun, 31 Oct 2010 09:55:05 +0100
Subject: [Slony1-general] Slony1-general Digest, Vol 44, Issue 16
In-Reply-To: <mailman.1.1288119602.25883.slony1-general@lists.slony.info>
References: <mailman.1.1288119602.25883.slony1-general@lists.slony.info>
Message-ID: <4CCD2EE9.1040405@adyen.com>

Can we change the definitions of all 'timestamp' columns
from 'timestamp without time zone' to timestamp with time stamp'
in slony (we are using 1.2.20 rightnow).


Regards,

Ger Timmens

-- 
Ger Timmens

