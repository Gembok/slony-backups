From bugzilla-daemon at main.slony.info  Fri Nov  4 13:02:08 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Fri,  4 Nov 2011 13:02:08 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 247] New: Slony log shipper doesn't parse
	TRUNCATE
Message-ID: <bug-247-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=247

           Summary: Slony log shipper doesn't parse TRUNCATE
           Product: Slony-I
           Version: devel
          Platform: PC
        OS/Version: Linux
            Status: NEW
          Severity: enhancement
          Priority: low
         Component: slony_logshipper
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: ssinger at ca.afilias.info
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


This bug applies to 2.1 and master (2.2)

Slony 2.1 added support for replicating TRUNCATE commands.

The slony_logshipper daemon has a parser.y that it uses to parse the log ship
files generated by slon.  The grammer in this file (and associated handling
code) can not deal with TRUNCATE commands.

You get the following error
ERROR 2011-11-04 15:55:28 >
/tmp/logreformat/slony1_log_4_00000000000000000139.sql:12: ERROR syntax error
at or near TRUNCATE

from a line in the log file like:
TRUNCATE ONLY "disorder"."do_item_review" CASCADE;

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

From bugzilla-daemon at main.slony.info  Fri Nov  4 13:21:10 2011
From: bugzilla-daemon at main.slony.info (bugzilla-daemon at main.slony.info)
Date: Fri,  4 Nov 2011 13:21:10 -0700 (PDT)
Subject: [Slony1-bugs] [Bug 248] New: Log shipper targets can't add
 sequences after initial setup
Message-ID: <bug-248-4@http.www.slony.info/bugzilla/>

http://www.slony.info/bugzilla/show_bug.cgi?id=248

           Summary: Log shipper targets can't add sequences after initial
                    setup
           Product: Slony-I
           Version: 2.0
          Platform: PC
        OS/Version: Linux
            Status: NEW
          Severity: enhancement
          Priority: low
         Component: slon
        AssignedTo: slony1-bugs at lists.slony.info
        ReportedBy: ssinger at ca.afilias.info
                CC: slony1-bugs at lists.slony.info
   Estimated Hours: 0.0


The slony1_dump.sh creates a sl_sequence_offline table for tracking sequences
on a log shipping target.

If you add+subscribe a new sequence to a new set after the log shipping slave
has been setup then the slon generating the log ship files will not generate
any SQL to update sl_sequence_offline to reflect the new sequence.  Updates to
the sequence then fail on the log shipping target.

I have changes to the LogShipping.js disorder test to replicate this issue that
I will include with the fix.

I think 2.0 2.1 and 2.2 all have this bug (I haven't looked at the log shipping
code in 1.2)

-- 
Configure bugmail: http://www.slony.info/bugzilla/userprefs.cgi?tab=email
------- You are receiving this mail because: -------
You are on the CC list for the bug.
You are the assignee for the bug.

